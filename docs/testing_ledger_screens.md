# ุฏููู ุงูุงุฎุชุจุงุฑ ุงูุณุฑูุน - ุฏูุชุฑ ุงูุฃุณุชุงุฐ ุงููุทูุฑ

## ุงููุดููุฉ ุงูุชู ุชู ุญููุง

ูุงู ููุงู ุฎุทุฃ ูู Backend ุนูุฏ ูุญุงููุฉ ุงููุตูู ุฅูู `line.account.name` ุนูุฏูุง ูููู `account` ูู `None`:

```python
AttributeError: 'NoneType' object has no attribute 'name'
```

### ุงูุญู
ุชู ุฅุถุงูุฉ ูุญุต ูุจู ุงููุตูู ุฅูู ุฎุตุงุฆุต `account`:

```python
# ูุจู ุงูุฅุตูุงุญ
'account_name': line.account.name,

# ุจุนุฏ ุงูุฅุตูุงุญ
'account_name': line.account.name if line.account else 'Unknown Account',
```

---

## ุงุฎุชุจุงุฑ APIs (Backend)

### 1. ุฏูุชุฑ ุงูุฃุณุชุงุฐ ุงูุนุงู
```bash
curl "http://127.0.0.1:8001/api/general_ledger_all?show_balances=true&karat_detail=true"
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**: JSON ูุญุชูู ุนูู:
- โ `entries`: ูุงุฆูุฉ ุงูุญุฑูุงุช
- โ `summary`: ููุฎุต ูุน `final_balance`
- โ `filters`: ุงูููุงุชุฑ ุงููุณุชุฎุฏูุฉ
- โ `running_balance` ููู ุญุฑูุฉ
- โ `karat_details` ูุน ุชูุฒูุน ุงูุฃุนูุฑุฉ

### 2. ุฏูุชุฑ ุฃุณุชุงุฐ ุญุณุงุจ ูุญุฏุฏ
```bash
curl "http://127.0.0.1:8001/api/account_ledger/55?karat_detail=true"
```

**ุงููุชูุฌุฉ ุงููุชููุนุฉ**: JSON ูุญุชูู ุนูู:
- โ `account`: ูุนูููุงุช ุงูุญุณุงุจ
- โ `opening_balance`: ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู
- โ `closing_balance`: ุงูุฑุตูุฏ ุงูุฎุชุงูู
- โ `entries`: ุงูุญุฑูุงุช ูุน ุฃุฑุตุฏุฉ ุชุฑุงูููุฉ
- โ `total_entries`: ุนุฏุฏ ุงูุญุฑูุงุช

---

## ุงุฎุชุจุงุฑ ุงูุดุงุดุงุช (Flutter)

### ุฎุทูุงุช ุงูุงุฎุชุจุงุฑ

#### 1. ุชุดุบูู Backend
```bash
cd /Users/salehalabbadi/yasargold/backend
source venv/bin/activate
python app.py
```

#### 2. ุชุดุบูู Flutter
```bash
cd /Users/salehalabbadi/yasargold/frontend
flutter run -d macos
```

#### 3. ุงุฎุชุจุงุฑ ุฏูุชุฑ ุงูุฃุณุชุงุฐ ุงูุนุงู

**ุงููุตูู**: ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ โ ุฏูุชุฑ ุงูุฃุณุชุงุฐ ุงูุนุงู

**ุงูุฎุทูุงุช**:
1. ุงููุฑ ุนูู ุฃููููุฉ ุงูุชุตููุฉ (filter_list) ูู ุงูุฃุนูู
2. ุงุฎุชุฑ ุญุณุงุจ ูู ุงููุงุฆูุฉ ุงูููุณุฏูุฉ
3. ุงุฎุชุฑ ุชุงุฑูุฎ ุงูุจุฏุงูุฉ ูุงูููุงูุฉ
4. ูุนูู "ุนุฑุถ ุงูุฃุฑุตุฏุฉ ุงูุชุฑุงูููุฉ"
5. ูุนูู "ุนุฑุถ ุชูุงุตูู ุงูุฃุนูุฑุฉ"
6. ุงุถุบุท "ุชุทุจูู"

**ุงููุชุงุฆุฌ ุงููุชููุนุฉ**:
- โ ูุธูุฑ ููุฎุต ูู ุงูุฃุนูู ูุน:
  - ุนุฏุฏ ุงูุญุฑูุงุช
  - ุงูุฑุตูุฏ ุงูููุฏู ุงูููุงุฆู
  - ุฑุตูุฏ ุงูุฐูุจ ุงูููุงุฆู
  - ุชูุงุตูู ุงูุฃุนูุฑุฉ (ุฅุฐุง ููุนููุช)
- โ ูู ุญุฑูุฉ ูุงุจูุฉ ููุชูุณูุน ูุนุฑุถ:
  - ุงููุจุงูุบ (ููุฏ ูุฏูู/ุฏุงุฆู)
  - ุงูุฃูุฒุงู (ุฐูุจ ูุฏูู/ุฏุงุฆู)
  - ุงูุฑุตูุฏ ุงูุชุฑุงููู
  - ุฌุฏูู ุงูุฃุนูุฑุฉ

#### 4. ุงุฎุชุจุงุฑ ุฏูุชุฑ ุฃุณุชุงุฐ ุงูุญุณุงุจ

**ุงููุตูู**: 
- ุงูุทุฑููุฉ 1: ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ โ ุญุณุงุจุงุช ุงูุนููุงุก โ [ุงุฎุชุฑ ุนููู] โ ุฃููููุฉ ุงููุชุงุจ ๐
- ุงูุทุฑููุฉ 2: ุฃู ุดุงุดุฉ ุญุณุงุจุงุช โ ุฃููููุฉ ุงููุชุงุจ

**ุงูุฎุทูุงุช**:
1. ุงูุชุญ ูุงุฆูุฉ ุงูุญุณุงุจุงุช
2. ุงุฎุชุฑ ุญุณุงุจ ุนููู
3. ุงููุฑ ุนูู ุฃููููุฉ ุงููุชุงุจ ๐ (ุจุฌุงูุจ ุงุณู ุงูุนููู)
4. ุงููุฑ ุนูู ุฃููููุฉ ุงูุชุงุฑูุฎ ูุชุญุฏูุฏ ูุชุฑุฉ
5. ุดุงูุฏ ุงููุชุงุฆุฌ

**ุงููุชุงุฆุฌ ุงููุชููุนุฉ**:
- โ ุจุทุงูุฉ ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู ูู ุงูุฃุนูู (ููุฏ + ุฐูุจ)
- โ ูุงุฆูุฉ ุงูุญุฑูุงุช ูุน:
  - ุงูุชุงุฑูุฎ ูุงููุตู
  - ุงููุจุงูุบ ูู Chips ููููุฉ
  - ุงูุฑุตูุฏ ุงูุชุฑุงููู ูู ุงูุฌุงูุจ ุงูุฃูุณุฑ
- โ ุจุทุงูุฉ ุงูุฑุตูุฏ ุงูุฎุชุงูู ูู ุงูุฃุณูู
- โ ุงูููุฑ ุนูู ุฃู ุญุฑูุฉ ูุนุฑุถ ูุงูุฐุฉ ุชูุงุตูู ุงูุฃุนูุฑุฉ

---

## ุงููุดุงูู ุงูุดุงุฆุนุฉ ูุญููููุง

### Problem 1: "Failed to load ledger"
**ุงูุณุจุจ**: Backend ุบูุฑ ูุดุบู ุฃู ูุง ูุนูู ุนูู port 8001
**ุงูุญู**: 
```bash
lsof -i :8001  # ุชุญูู ูู ุชุดุบูู Backend
cd backend && source venv/bin/activate && python app.py
```

### Problem 2: ุดุงุดุฉ ูุงุฑุบุฉ (no data)
**ุงูุณุจุจ**: ูุง ุชูุฌุฏ ูููุฏ ูุญุงุณุจูุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
**ุงูุญู**: ุฃูุดุฆ ูุงุชูุฑุฉ ุจูุน ุฃู ุดุฑุงุก ูู ุงูุชุทุจูู ูุชูููุฏ ูููุฏ ุชููุงุฆูุงู

### Problem 3: "Unknown Account" ูู ุงูุฃุณูุงุก
**ุงูุณุจุจ**: ุญุณุงุจ ุชู ุญุฐูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ููู ูููุฏู ููุฌูุฏุฉ
**ุงูุญู**: ุทุจูุนู - ูุฐุง ูุญูุงูุฉ ุงูุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ

### Problem 4: ุงูุฃุฑุตุฏุฉ ุบูุฑ ูุชูุงุฒูุฉ
**ุงูุณุจุจ**: ุฎุทุฃ ูู ุฅุฏุฎุงู ุงููููุฏ ุงููุฏููุฉ
**ุงูุญู**: ุงุณุชุฎุฏู `/api/trial_balance` ููุชุญูู ูู ุงูุชูุงุฒู

---

## ุงูุชุญูู ูู ุนูู ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### โ ูุงุฆูุฉ ุงูุชุญูู

#### Backend APIs
- [x] `GET /api/general_ledger_all` ูุนูู ุจุฏูู ุฃุฎุทุงุก
- [x] ุงูุชุตููุฉ ุญุณุจ `account_id` ุชุนูู
- [x] ุงูุชุตููุฉ ุญุณุจ `start_date`, `end_date` ุชุนูู
- [x] `show_balances=true` ููุฑุฌุน ุฃุฑุตุฏุฉ ุชุฑุงูููุฉ
- [x] `karat_detail=true` ููุฑุฌุน ุชูุงุตูู ุงูุฃุนูุฑุฉ
- [x] `GET /api/account_ledger/<id>` ูุนูู
- [x] ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู ููุญุณุจ ุตุญูุญุงู
- [x] ุงูุฑุตูุฏ ุงูุฎุชุงูู = ุงูุชุชุงุญู + ุญุฑูุงุช

#### Frontend Screens
- [ ] `general_ledger_screen_v2.dart` ุชุธูุฑ ูู ุงูุชุทุจูู
- [ ] ูุงูุฐุฉ ุงูุชุตููุฉ ุชุนูู
- [ ] ุงุฎุชูุงุฑ ุงูุญุณุงุจ ูุนูู
- [ ] ุงุฎุชูุงุฑ ุงูุชุงุฑูุฎ ูุนูู
- [ ] ุจุทุงูุฉ ุงูููุฎุต ุชุนุฑุถ ุงูุจูุงูุงุช ุตุญูุญุงู
- [ ] ุงูุญุฑูุงุช ูุงุจูุฉ ููุชูุณูุน
- [ ] ุฌุฏูู ุงูุฃุนูุฑุฉ ูุธูุฑ ุจุดูู ุตุญูุญ
- [ ] `account_ledger_screen.dart` ูููู ุงููุตูู ุฅููู
- [ ] ุฃููููุฉ ุงููุชุงุจ ููุฌูุฏุฉ ูู ุดุงุดุฉ ุงูุญุณุงุจุงุช
- [ ] ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู ูุงูุฎุชุงูู ูุธูุฑุงู

---

## ููุทุงุช ุงูุดุงุดุฉ ุงููุชููุนุฉ

### ุฏูุชุฑ ุงูุฃุณุชุงุฐ ุงูุนุงู
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุฏูุชุฑ ุงูุฃุณุชุงุฐ ุงูุนุงู        ๐ ๐ โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ ๐ ุงูููุฎุต                         โ
โ   ุนุฏุฏ ุงูุญุฑูุงุช: 50                โ
โ   ุงูุฑุตูุฏ ุงูููุฏู: 10,000 ุฑ.ุณ      โ
โ   ุฑุตูุฏ ุงูุฐูุจ: 25.5 ุฌู             โ
โ   [ 18k | 21k | 22k | 24k ]       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ ๐ ูุงุชูุฑุฉ ุจูุน ุฑูู #15             โ
โ    2024-01-15 | ูุจูุนุงุช ุฐูุจ        โ
โ    ๐ต ููุฏ ุฏุงุฆู: 1000 ุฑ.ุณ          โ
โ    โ๏ธ  ุฐูุจ ูุฏูู: 2.857 ุฌู         โ
โ    ๐ ุฑุตูุฏ: 1000 ุฑ.ุณ | 2.857 ุฌู   โ
โ    [ ุงุถุบุท ูุนุฑุถ ุชูุงุตูู ุงูุฃุนูุฑุฉ ]   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ุฏูุชุฑ ุฃุณุชุงุฐ ุงูุญุณุงุจ
```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุฏูุชุฑ ุงูุฃุณุชุงุฐ                ๐ ๐โ
โ  ุฃุญูุฏ ูุญูุฏ                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ ๐ฆ ุงูุฑุตูุฏ ุงูุงูุชุชุงุญู               โ
โ    ููุฏ: 1,000 ุฑ.ุณ                 โ
โ    ุฐูุจ: 2.5 ุฌู (21k)              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ ุนุฏุฏ ุงูุญุฑูุงุช: 5                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ ๐ ูุจูุนุงุช ุฐูุจ                     โ
โ    2024-01-15 10:00               โ
โ    [ููุฏ ุฏุงุฆู: 500] [ุฐูุจ ูุฏูู...]  โ
โ    ุฑุตูุฏ: 1,500 ุฑ.ุณ | 1.2 ุฌู      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโฃ
โ ๐ฉ ุงูุฑุตูุฏ ุงูุฎุชุงูู                 โ
โ    ููุฏ: 1,500 ุฑ.ุณ                 โ
โ    ุฐูุจ: 1.2 ุฌู (21k)              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ุฅุฐุง ูุงูุช ุงูุดุงุดุงุช ูุง ุชุนูู:

1. **ุชุฃูุฏ ูู ุชุญุฏูุซ `main.dart`**:
   ```bash
   grep "GeneralLedgerScreenV2" frontend/lib/screens/home_screen.dart
   ```
   ูุฌุจ ุฃู ูุธูุฑ ุงููุชูุฌุฉ

2. **ุฃุนุฏ ุชุดุบูู Flutter**:
   ```bash
   flutter clean
   flutter pub get
   flutter run -d macos
   ```

3. **ุชุญูู ูู ุงูุฃุฎุทุงุก**:
   ```bash
   flutter analyze
   ```

4. **ุงูุญุต ุงูุณุฌูุงุช**:
   - Backend: `tail -f /tmp/backend.log`
   - Flutter: ุดุงูุฏ console ูู VS Code

---

## ุงูููุฎุต

ุชู ุฅุตูุงุญ:
- โ ุฎุทุฃ `NoneType` ูู Backend
- โ API ุฏูุชุฑ ุงูุฃุณุชุงุฐ ุงูุนุงู ูุนูู ุจูุงูู ุงูููุฒุงุช
- โ API ุฏูุชุฑ ุฃุณุชุงุฐ ุงูุญุณุงุจ ูุนูู ุจูุงูู ุงูููุฒุงุช
- โ ุงูุดุงุดุงุช ุงูุฌุฏูุฏุฉ ุชู ุฅูุดุงุคูุง ูุชูุงูููุง

ุงูุฎุทูุฉ ุงูุชุงููุฉ:
- ุงุฎุชุจุงุฑ ุงูุดุงุดุงุช ูู Flutter
- ุงูุชุฃูุฏ ูู ุธููุฑ ุงูุจูุงูุงุช ุจุดูู ุตุญูุญ
- ุชุญุณูู ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ุฅุฐุง ูุฒู ุงูุฃูุฑ
