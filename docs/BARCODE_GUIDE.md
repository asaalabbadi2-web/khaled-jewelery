# ๐ฆ ุฏููู ุงุณุชุฎุฏุงู ูุธุงู ุงูุจุงุฑููุฏ ูู Yasar POS

## ๐ ุฌุฏูู ุงููุญุชููุงุช
1. [ูุธุฑุฉ ุนุงูุฉ](#ูุธุฑุฉ-ุนุงูุฉ)
2. [ุงูุจููุฉ ุงูุชูููุฉ](#ุงูุจููุฉ-ุงูุชูููุฉ)
3. [ููููุฉ ุญูุธ ุงูุจุงุฑููุฏ](#ููููุฉ-ุญูุธ-ุงูุจุงุฑููุฏ)
4. [ููููุฉ ุงุณุชุฎุฏุงู ุงูุจุงุฑููุฏ](#ููููุฉ-ุงุณุชุฎุฏุงู-ุงูุจุงุฑููุฏ)
5. [ุฃูุซูุฉ ุนูููุฉ](#ุฃูุซูุฉ-ุนูููุฉ)

---

## ๐ฏ ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุงูุจุงุฑููุฏ ูู Yasar POS ูุณูุญ ุจู:
- โ ุชุนุฑูู ูู ุตูู ุจุฑูุฒ ุจุงุฑููุฏ ูุฑูุฏ
- โ ุงููุณุญ ุงูุณุฑูุน ููุฃุตูุงู ุฃุซูุงุก ุฅูุดุงุก ุงูููุงุชูุฑ
- โ ุงูุจุญุซ ุงูุชููุงุฆู ูููุก ุงูุจูุงูุงุช

---

## ๐๏ธ ุงูุจููุฉ ุงูุชูููุฉ

### Backend (ูุงุนุฏุฉ ุงูุจูุงูุงุช)

**ุงูุฌุฏูู**: `item`

```sql
CREATE TABLE item (
    id INTEGER PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    barcode VARCHAR(100) UNIQUE,  -- โ ุงูุญูู ุงูุฌุฏูุฏ
    karat VARCHAR(10),
    weight FLOAT,
    count INTEGER,
    wage FLOAT,
    description VARCHAR(200),
    price FLOAT NOT NULL,
    stock INTEGER DEFAULT 0
);

-- ููุฑุณ ูุฑูุฏ ููุจุญุซ ุงูุณุฑูุน
CREATE UNIQUE INDEX ix_item_barcode ON item(barcode);
```

**Model**: `backend/models.py`
```python
class Item(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False)
    barcode = db.Column(db.String(100), unique=True, nullable=True, index=True)
    # ... ุจุงูู ุงูุญููู
```

### API Endpoints

#### 1. ุฌูุจ ุฌููุน ุงูุฃุตูุงู (ูุน ุงูุจุงุฑููุฏ)
```http
GET /api/items
Response:
[
  {
    "id": 1,
    "name": "ุฎุงุชู ุฐูุจ",
    "barcode": "8901234567890",  โ ุงูุจุงุฑููุฏ
    "karat": "21",
    "weight": 5.5,
    "price": 2500.0
  }
]
```

#### 2. ุฅุถุงูุฉ ุตูู ุฌุฏูุฏ
```http
POST /api/items
Body:
{
  "name": "ุณูุงุฑ ุฐูุจ",
  "barcode": "8901234567891",  โ ุงุฎุชูุงุฑู
  "karat": "18",
  "weight": 10.2,
  "price": 3500.0
}
```

#### 3. ุชุญุฏูุซ ุตูู
```http
PUT /api/items/1
Body:
{
  "barcode": "8901234567892"  โ ุชุญุฏูุซ ุงูุจุงุฑููุฏ
}
```

---

## ๐พ ููููุฉ ุญูุธ ุงูุจุงุฑููุฏ

### ุงูุณููุงุฑูู 1: ุฅุถุงูุฉ ุตูู ุฌุฏูุฏ ูู ุดุงุดุฉ ุงูุฃุตูุงู

```dart
// ูู Flutter
final newItem = {
  'name': 'ุนูุฏ ุฐูุจ',
  'barcode': scannedBarcode,  // ูู ุงููุงุณุญ
  'karat': '21',
  'weight': 15.5,
  'price': 5000.0
};

// ุฅุฑุณุงู ูู Backend
await http.post(
  Uri.parse('$baseUrl/api/items'),
  body: jsonEncode(newItem),
);
```

### ุงูุณููุงุฑูู 2: ุฅุถุงูุฉ ุจุงุฑููุฏ ูุตูู ููุฌูุฏ

```dart
// ุชุญุฏูุซ ุตูู ููุฌูุฏ
await http.put(
  Uri.parse('$baseUrl/api/items/$itemId'),
  body: jsonEncode({
    'barcode': '8901234567890'
  }),
);
```

### ุงูุณููุงุฑูู 3: ุงูุจูุงูุงุช ุชุฃุชู ูู ุงููุงุชูุฑุฉ

ุนูุฏูุง ููุณุญ ุงููุณุชุฎุฏู ุจุงุฑููุฏ ูู ุดุงุดุฉ ุงููุงุชูุฑุฉ:

```dart
// ูู add_invoice_screen.dart (ุงูุณุทุฑ ~1430)
final code = await Navigator.push(
  context,
  MaterialPageRoute(
    builder: (_) => _BarcodeScannerPlaceholder(),
  ),
);

if (code != null) {
  // ุงูุจุญุซ ูู ุงูุฃุตูุงู ุงูููุฌูุฏุฉ
  final item = widget.items.firstWhere(
    (item) => item['barcode'] == code,
    orElse: () => {},
  );
  
  if (item.isNotEmpty) {
    // โ ุงูุตูู ููุฌูุฏ - ุงููุฃ ุงูุญููู
    _handleItemSelected(item);
  } else {
    // โ๏ธ ุงูุตูู ุบูุฑ ููุฌูุฏ - ูููู ุฅุถุงูุชู ูุตูู ุฌุฏูุฏ
    showDialog(/* ุฎูุงุฑ ุฅุถุงูุฉ ุตูู ุฌุฏูุฏ */);
  }
}
```

---

## ๐ฎ ููููุฉ ุงุณุชุฎุฏุงู ุงูุจุงุฑููุฏ

### 1๏ธโฃ **ูู ุดุงุดุฉ ุงูุฃุตูุงู** (ุฅุฏุงุฑุฉ ุงููุฎุฒูู)

```
1. ูุชุญ ุดุงุดุฉ ุงูุฃุตูุงู
2. ุฅุถุงูุฉ ุตูู ุฌุฏูุฏ
3. ูู ุญูู "ุงูุจุงุฑููุฏ":
   - ุฎูุงุฑ 1: ูุณุญ ุงูุจุงุฑููุฏ ุจุงููุงุณุญ
   - ุฎูุงุฑ 2: ูุชุงุจุฉ ุงูุฑูู ูุฏููุงู
4. ุญูุธ ุงูุตูู
```

### 2๏ธโฃ **ูู ุดุงุดุฉ ุงูููุงุชูุฑ** (ููุทุฉ ุงูุจูุน)

```
1. ูุชุญ ุดุงุดุฉ ุฅุถุงูุฉ ูุงุชูุฑุฉ
2. ุงูุงูุชูุงู ูุฎุทูุฉ "ุงูุฃุตูุงู"
3. ูู ุญูู "ุงุณู ุงูุตูู":
   - ุงูููุฑ ุนูู ุฃููููุฉ ๐ท ุงูุฒุฑูุงุก
   - ูุณุญ ุจุงุฑููุฏ ุงูุตูู
   
4. ุงููุชุงุฆุฌ:
   โ ุฅุฐุง ููุฌุฏ: ููุก ุฌููุน ุงูุญููู ุชููุงุฆูุงู
      - ุงูุงุณู
      - ุงูุนูุงุฑ  
      - ุงููุฒู
      - ุงูุณุนุฑ
      
   โ๏ธ ุฅุฐุง ูู ูููุฌุฏ: ุฑุณุงูุฉ ุชูุจูู
      "ูู ูุชู ุงูุนุซูุฑ ุนูู ุตูู ุจุงูุจุงุฑููุฏ: XXXXX"
```

---

## ๐ ุฃูุซูุฉ ุนูููุฉ

### ูุซุงู 1: ุฅุถุงูุฉ ุตูู ุฌุฏูุฏ ูุน ุจุงุฑููุฏ

**ุงูุทุฑููุฉ ุงููุฏููุฉ**:
```json
POST /api/items
{
  "name": "ุฎุงุชู ุฒูุงุฌ ุฐูุจ ุฃุจูุถ",
  "barcode": "8901234500001",
  "karat": "18",
  "weight": 3.5,
  "wage": 150.0,
  "price": 1500.0,
  "stock": 5
}
```

**ูู Flutter**:
```dart
final item = {
  'name': 'ุฎุงุชู ุฒูุงุฌ ุฐูุจ ุฃุจูุถ',
  'barcode': await scanBarcode(), // ูุณุญ ุงูุจุงุฑููุฏ
  'karat': '18',
  'weight': 3.5,
  'wage': 150.0,
  'price': 1500.0,
  'stock': 5
};

await ApiService().createItem(item);
```

### ูุซุงู 2: ุงูุจุญุซ ุจุงูุจุงุฑููุฏ ูู ุงููุงุชูุฑุฉ

**ุงูุณููุงุฑูู**: ุนููู ูุดุชุฑู 3 ุฃุตูุงู

```dart
// ุงูุตูู 1: ูุณุญ ุจุงุฑููุฏ
onPressed: () async {
  final barcode = await scanBarcode(); // "8901234500001"
  
  // ุงูุจุญุซ ูู items
  final foundItem = items.firstWhere(
    (i) => i['barcode'] == barcode,
    orElse: () => null,
  );
  
  if (foundItem != null) {
    // ููุก ุงูุญููู ุชููุงุฆูุงู
    _itemNameController.text = foundItem['name'];
    _itemKaratController.text = foundItem['karat'];
    _itemWeightController.text = foundItem['weight'].toString();
    _calculateTotals();
  }
}
```

### ูุซุงู 3: ุชุญุฏูุซ ุจุงุฑููุฏ ูุตูู ููุฌูุฏ

```dart
// ูุฏูู ุตูู ID=5 ุชุฑูุฏ ุฅุถุงูุฉ ุจุงุฑููุฏ ูู
await http.put(
  Uri.parse('$baseUrl/api/items/5'),
  headers: {'Content-Type': 'application/json'},
  body: jsonEncode({
    'barcode': '8901234500002'
  }),
);
```

---

## ๐ ููุงุนุฏ ุงูุจุงุฑููุฏ

### โ ุงูููุงุนุฏ ุงูุฃุณุงุณูุฉ:
1. **ูุฑูุฏ (Unique)**: ูู ุจุงุฑููุฏ ูุฌุจ ุฃู ูููู ูุฑูุฏุงู
2. **ุงุฎุชูุงุฑู (Nullable)**: ูููู ุชุฑู ุงูุญูู ูุงุฑุบุงู
3. **ูููุฑุณ (Indexed)**: ููุจุญุซ ุงูุณุฑูุน
4. **ุทูู ูุชุบูุฑ**: ุญุชู 100 ุญุฑู

### โ๏ธ ุงูุฃุฎุทุงุก ุงููุญุชููุฉ:

```python
# ุฎุทุฃ: ุจุงุฑููุฏ ููุฑุฑ
UNIQUE constraint failed: item.barcode
โ ุงูุญู: ุงุณุชุฎุฏู ุจุงุฑููุฏ ูุฎุชูู
```

```python
# ุฎุทุฃ: ุจุงุฑููุฏ ุทููู ุฌุฏุงู
value too long for type character varying(100)
โ ุงูุญู: ุงุณุชุฎุฏู ุจุงุฑููุฏ ุฃูุตุฑ
```

---

## ๐ ุชุฏูู ุงูุจูุงูุงุช ุงููุงูู

```
1. ุงููุงุณุญ ุงูุถูุฆู (Mobile Scanner)
   โ
2. ูุฑุงุกุฉ ุงูุจุงุฑููุฏ โ "8901234500001"
   โ
3. ุงูุจุญุซ ูู ูุงุฆูุฉ items[]
   โ
4. ุชุทุงุจู item['barcode'] == scannedCode?
   โโ ูุนู โ ููุก ุงูุญููู
   โโ ูุง โ ุฑุณุงูุฉ ุชูุจูู
```

---

## ๐ ุฎุทูุงุช ุงูุชุทุจูู ุงููุงููุฉ

### โ ุชู ุชูููุฐู:
- [x] ุฅุถุงูุฉ ุญูู `barcode` ูุฌุฏูู `item`
- [x] ุชุญุฏูุซ `Model` ูู `backend/models.py`
- [x] ุชุญุฏูุซ API endpoints (GET, POST, PUT)
- [x] ุฏูุฌ ูุงุณุญ ุงูุจุงุฑููุฏ ูู ุดุงุดุฉ ุงููุงุชูุฑุฉ
- [x] ููุทู ุงูุจุญุซ ูุงูููุก ุงูุชููุงุฆู

### ๐ ุฎุทูุงุช ูุณุชูุจููุฉ (ุงุฎุชูุงุฑูุฉ):
- [ ] ุฅุถุงูุฉ ุดุงุดุฉ ุฅุฏุงุฑุฉ ุงูุฃุตูุงู ูุน ุฏุนู ุงูุจุงุฑููุฏ
- [ ] ุทุจุงุนุฉ ููุตูุงุช ุงูุจุงุฑููุฏ
- [ ] ุงุณุชูุฑุงุฏ ุงูุฃุตูุงู ูู Excel ูุน ุจุงุฑููุฏุงุช
- [ ] ุชูุงุฑูุฑ ุงูุฃุตูุงู ุจุฏูู ุจุงุฑููุฏ

---

## ๐ ุงูุฏุนู

ููุฃุณุฆูุฉ ุฃู ุงููุดุงููุ ุฑุงุฌุน:
- `backend/models.py` - ุชุนุฑูู ุงูู Model
- `backend/routes.py` - API endpoints
- `frontend/lib/screens/add_invoice_screen.dart` - ุดุงุดุฉ ุงููุงุชูุฑุฉ
- `frontend/lib/features/invoice/widgets/barcode_scanner_screen.dart` - ุงููุงุณุญ

---

**ุขุฎุฑ ุชุญุฏูุซ**: 12 ุฃูุชูุจุฑ 2025  
**ุงูุญุงูุฉ**: โ ุฌุงูุฒ ููุฅูุชุงุฌ
