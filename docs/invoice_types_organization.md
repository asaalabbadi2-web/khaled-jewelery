# ุชูุธูู ุฃููุงุน ุงูููุงุชูุฑ ูู ูุธุงู ูุงุณุฑ ููุฐูุจ

## ๐ ุงูุชูุณูู ุงููุธููู ููููุงุชูุฑ

### ๐ช ูุณู ููุงุท ุงูุจูุน (POS Section)
**ุงููุนุงููุงุช ูุน ุงูุนููุงุก (Customer Transactions)**

#### 1. ูุงุชูุฑุฉ ุจูุน (`ุจูุน`)
- **ุงููุตู:** ุจูุน ุฐูุจ ุฌุฏูุฏ ููุนููู
- **ุงูุทุฑู:** Customer
- **ูุงุฌูุฉ:** POS Section โ ูุงุชูุฑุฉ ุจูุน
- **ุงูููุฏ ุงููุญุงุณุจู:**
  ```
  ูู ุญู/ ุงูุนููู (ุฃู ุงูุตูุฏูู)        [ูุฏูู]
      ุฅูู ุญู/ ุงููุฎุฒูู - ุฐูุจ          [ุฏุงุฆู]
      ุฅูู ุญู/ ุงูุฅูุฑุงุฏุงุช              [ุฏุงุฆู]
  ```

#### 2. ูุงุชูุฑุฉ ุดุฑุงุก ูุณุฑ ูู ุนููู (`ุดุฑุงุก ูู ุนููู`)
- **ุงููุตู:** ุดุฑุงุก ุฐูุจ ูุณุชุนูู/ูุณุฑ ูู ุงูุนููู
- **ุงูุทุฑู:** Customer
- **ูุงุฌูุฉ:** POS Section โ ูุงุชูุฑุฉ ุดุฑุงุก ูุณุฑ
- **ุงูููุฏ ุงููุญุงุณุจู:**
  ```
  ูู ุญู/ ุงููุฎุฒูู - ูุณุฑ ุฐูุจ        [ูุฏูู]
      ุฅูู ุญู/ ุงูุนููู (ุฃู ุงูุตูุฏูู)  [ุฏุงุฆู]
  ```

#### 3. ูุฑุชุฌุน ูุงุชูุฑุฉ ุจูุน (`ูุฑุชุฌุน ุจูุน`)
- **ุงููุตู:** ุงูุนููู ูุฑุฌุน ุฐูุจ ูุดุชุฑู ูููุญู
- **ุงูุทุฑู:** Customer
- **ูุงุฌูุฉ:** POS Section โ ูุฑุชุฌุน ุจูุน
- **ูุฑุชุจุทุฉ ุจู:** ูุงุชูุฑุฉ ุจูุน ุฃุตููุฉ (`original_invoice_id`)
- **ุงูููุฏ ุงููุญุงุณุจู (ุนูุณ ุงูุจูุน):**
  ```
  ูู ุญู/ ุงููุฎุฒูู - ุฐูุจ                [ูุฏูู]
  ูู ุญู/ ุงูุฅูุฑุงุฏุงุช (ุนูุณ ุงูููุฏ)        [ูุฏูู]
      ุฅูู ุญู/ ุงูุนููู (ุฃู ุงูุตูุฏูู)     [ุฏุงุฆู]
  ```

#### 4. ูุฑุชุฌุน ุดุฑุงุก ูุณุฑ ูู ุนููู (`ูุฑุชุฌุน ุดุฑุงุก`)
- **ุงููุตู:** ุงููุญู ูุฑุฌุน ุงููุณุฑ ููุนููู
- **ุงูุทุฑู:** Customer
- **ูุงุฌูุฉ:** POS Section โ ูุฑุชุฌุน ุดุฑุงุก ูุณุฑ
- **ูุฑุชุจุทุฉ ุจู:** ูุงุชูุฑุฉ ุดุฑุงุก ูุณุฑ ุฃุตููุฉ (`original_invoice_id`)
- **ุงูููุฏ ุงููุญุงุณุจู (ุนูุณ ุงูุดุฑุงุก):**
  ```
  ูู ุญู/ ุงูุนููู (ุฃู ุงูุตูุฏูู)         [ูุฏูู]
      ุฅูู ุญู/ ุงููุฎุฒูู - ูุณุฑ ุฐูุจ      [ุฏุงุฆู]
  ```

---

### ๐ผ ูุณู ุงููุญุงุณุจุฉ (Accounting Section)
**ุงููุนุงููุงุช ูุน ุงูููุฑุฏูู (Supplier Transactions)**

#### 5. ูุงุชูุฑุฉ ุดุฑุงุก ูู ููุฑุฏ (`ุดุฑุงุก ูู ููุฑุฏ`)
- **ุงููุตู:** ุดุฑุงุก ุฐูุจ ุฌุฏูุฏ ูู ุงูููุฑุฏ
- **ุงูุทุฑู:** Supplier
- **ูุงุฌูุฉ:** Accounting Section โ ุงููุดุชุฑูุงุช โ ูุงุชูุฑุฉ ุดุฑุงุก
- **ุงูููุฏ ุงููุญุงุณุจู:**
  ```
  ูู ุญู/ ุงููุฎุฒูู - ุฐูุจ              [ูุฏูู]
      ุฅูู ุญู/ ุงูููุฑุฏ (ุฃู ุงูุตูุฏูู)    [ุฏุงุฆู]
  ```

#### 6. ูุฑุชุฌุน ุดุฑุงุก ูู ููุฑุฏ (`ูุฑุชุฌุน ุดุฑุงุก ูู ููุฑุฏ`)
- **ุงููุตู:** ุงููุญู ูุฑุฌุน ุฐูุจ ููููุฑุฏ
- **ุงูุทุฑู:** Supplier
- **ูุงุฌูุฉ:** Accounting Section โ ุงููุดุชุฑูุงุช โ ูุฑุชุฌุน ุดุฑุงุก
- **ูุฑุชุจุทุฉ ุจู:** ูุงุชูุฑุฉ ุดุฑุงุก ูู ููุฑุฏ ุฃุตููุฉ (`original_invoice_id`)
- **ุงูููุฏ ุงููุญุงุณุจู (ุนูุณ ุงูุดุฑุงุก):**
  ```
  ูู ุญู/ ุงูููุฑุฏ (ุฃู ุงูุตูุฏูู)         [ูุฏูู]
      ุฅูู ุญู/ ุงููุฎุฒูู - ุฐูุจ          [ุฏุงุฆู]
  ```

---

## ๐ ููุฎุต ุงููููู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              ๐ช ููุงุท ุงูุจูุน (POS)                        โ
โ         ูุนุงููุงุช ุงูุนููุงุก (Customer Transactions)        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ 1. ูุงุชูุฑุฉ ุจูุน                  (ุจูุน)                  โ
โ 2. ูุงุชูุฑุฉ ุดุฑุงุก ูุณุฑ ูู ุนููู    (ุดุฑุงุก ูู ุนููู)         โ
โ 3. ูุฑุชุฌุน ุจูุน                   (ูุฑุชุฌุน ุจูุน)            โ
โ 4. ูุฑุชุฌุน ุดุฑุงุก ูุณุฑ              (ูุฑุชุฌุน ุดุฑุงุก)           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              ๐ผ ุงููุญุงุณุจุฉ (Accounting)                   โ
โ         ูุนุงููุงุช ุงูููุฑุฏูู (Supplier Transactions)       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ 5. ูุงุชูุฑุฉ ุดุฑุงุก ูู ููุฑุฏ        (ุดุฑุงุก ูู ููุฑุฏ)         โ
โ 6. ูุฑุชุฌุน ุดุฑุงุก ูู ููุฑุฏ         (ูุฑุชุฌุน ุดุฑุงุก ูู ููุฑุฏ)   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ฏ ุชุญุฏูุซุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช ุงููุทููุจุฉ

### ูู `backend/models.py` - ุฌุฏูู `Invoice`:

```python
class Invoice(db.Model):
    id = db.Column(db.Integer, primary_key=True)
    invoice_type_id = db.Column(db.Integer, nullable=False)
    
    # ููุน ุงููุงุชูุฑุฉ (6 ุฃููุงุน)
    invoice_type = db.Column(db.String(50), nullable=False)
    # ุงูููู ุงููุณููุญุฉ:
    # - 'ุจูุน'
    # - 'ุดุฑุงุก ูู ุนููู'
    # - 'ูุฑุชุฌุน ุจูุน'
    # - 'ูุฑุชุฌุน ุดุฑุงุก'
    # - 'ุดุฑุงุก ูู ููุฑุฏ'
    # - 'ูุฑุชุฌุน ุดุฑุงุก ูู ููุฑุฏ'
    
    # ุงูุนููู (ูููุนุงููุงุช ูุน ุงูุนููุงุก)
    customer_id = db.Column(db.Integer, db.ForeignKey('customer.id'), nullable=True)
    
    # ุงูููุฑุฏ (ูููุนุงููุงุช ูุน ุงูููุฑุฏูู)
    supplier_id = db.Column(db.Integer, db.ForeignKey('supplier.id'), nullable=True)
    
    # ุฑุจุท ุจุงููุงุชูุฑุฉ ุงูุฃุตููุฉ (ูููุฑุชุฌุนุงุช ููุท)
    original_invoice_id = db.Column(db.Integer, db.ForeignKey('invoice.id'), nullable=True)
    original_invoice = db.relationship('Invoice', remote_side=[id], backref='returns')
    
    # ุณุจุจ ุงูุฅุฑุฌุงุน (ูููุฑุชุฌุนุงุช ููุท)
    return_reason = db.Column(db.Text, nullable=True)
    
    # ููุน ุงูุฐูุจ (new, scrap)
    gold_type = db.Column(db.String(20), nullable=True, server_default='new')
    
    date = db.Column(db.DateTime, nullable=False)
    total = db.Column(db.Float, nullable=False)
    status = db.Column(db.String(50), default='unpaid')
    
    # ... ุจุงูู ุงูุญููู
```

---

## ๐ฅ๏ธ ูุงุฌูุงุช ุงููุณุชุฎุฏู ุงููุทููุจุฉ

### ูู Frontend (Flutter):

#### ๐ฑ ูุณู ููุงุท ุงูุจูุน:
```dart
// ูู BottomNavigationBar ุฃู Drawer
โโโ ููุงุท ุงูุจูุน (POS)
    โโโ ูุงุชูุฑุฉ ุจูุน ุฌุฏูุฏุฉ
    โโโ ูุงุชูุฑุฉ ุดุฑุงุก ูุณุฑ ูู ุนููู
    โโโ ูุฑุชุฌุน ุจูุน
    โโโ ูุฑุชุฌุน ุดุฑุงุก ูุณุฑ
```

**ุงูุดุงุดุงุช ุงููุทููุจุฉ:**
1. `add_sales_invoice_screen.dart` - ูุงุชูุฑุฉ ุจูุน
2. `add_scrap_purchase_from_customer_screen.dart` - ุดุฑุงุก ูุณุฑ ูู ุนููู
3. `sales_return_screen.dart` - ูุฑุชุฌุน ุจูุน
4. `scrap_purchase_return_screen.dart` - ูุฑุชุฌุน ุดุฑุงุก ูุณุฑ

#### ๐ผ ูุณู ุงููุญุงุณุจุฉ:
```dart
// ูู ูุณู ุงููุญุงุณุจุฉ (Accounting)
โโโ ุงููุญุงุณุจุฉ
    โโโ ุงููุดุชุฑูุงุช (Purchases)
        โโโ ูุงุชูุฑุฉ ุดุฑุงุก ูู ููุฑุฏ
        โโโ ูุฑุชุฌุน ุดุฑุงุก ูู ููุฑุฏ
```

**ุงูุดุงุดุงุช ุงููุทููุจุฉ:**
1. `add_supplier_purchase_screen.dart` - ุดุฑุงุก ูู ููุฑุฏ
2. `supplier_purchase_return_screen.dart` - ูุฑุชุฌุน ุดุฑุงุก ูู ููุฑุฏ

---

## ๐ ููุงุนุฏ ุงูุนูู (Business Rules)

### ูููุฑุชุฌุนุงุช (Returns):

1. **ุฑุจุท ุฅูุฒุงูู:**
   - ูุฌุจ ุฃู ุชููู ุงููุฑุชุฌุนุงุช ูุฑุชุจุทุฉ ุจูุงุชูุฑุฉ ุฃุตููุฉ (`original_invoice_id`)

2. **ุงูุชุญูู ูู ุงููููุฉ:**
   - ูุง ูููู ุฅุฑุฌุงุน ุฃูุซุฑ ูู ุงููููุฉ ุงูุฃุตููุฉ
   - ุงูุชุญูู ูู ุงูุฃุตูุงู ุงูููุฌูุฏุฉ ูู ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ

3. **ุงูุชุญูู ูู ุงูุชุงุฑูุฎ:**
   - ุชุงุฑูุฎ ุงููุฑุชุฌุน ูุฌุจ ุฃู ูููู ุจุนุฏ ุชุงุฑูุฎ ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ

4. **ุญุงูุฉ ุงูุฏูุน:**
   - ุฅุฐุง ูุงูุช ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ ูุฏููุนุฉุ ูุชู ุฅุฑุฌุงุน ุงููุจูุบ
   - ุชุญุฏูุซ ุฑุตูุฏ ุงูุนููู/ุงูููุฑุฏ

5. **ุชุญุฏูุซ ุงููุฎุฒูู:**
   - ุงูุจูุน: ูุฎุฑุฌ ูู ุงููุฎุฒูู
   - ุงูุดุฑุงุก: ูุฏุฎู ูููุฎุฒูู
   - ูุฑุชุฌุน ุงูุจูุน: ูุฑุฌุน ูููุฎุฒูู
   - ูุฑุชุฌุน ุงูุดุฑุงุก: ูุฎุฑุฌ ูู ุงููุฎุฒูู

---

## ๐ ุงูุชูุงุฑูุฑ ุงููุทููุจุฉ

### ุชูุงุฑูุฑ ููุงุท ุงูุจูุน:
1. ุชูุฑูุฑ ูุจูุนุงุช ุงูููู/ุงูุดูุฑ
2. ุชูุฑูุฑ ูุดุชุฑูุงุช ุงููุณุฑ ูู ุงูุนููุงุก
3. ุชูุฑูุฑ ูุฑุชุฌุนุงุช ุงููุจูุนุงุช
4. ุชูุฑูุฑ ูุฑุชุฌุนุงุช ูุดุชุฑูุงุช ุงููุณุฑ
5. ุตุงูู ุงููุจูุนุงุช (ุจุนุฏ ุฎุตู ุงููุฑุชุฌุนุงุช)

### ุชูุงุฑูุฑ ุงููุญุงุณุจุฉ:
1. ุชูุฑูุฑ ูุดุชุฑูุงุช ูู ุงูููุฑุฏูู
2. ุชูุฑูุฑ ูุฑุชุฌุนุงุช ุงููุดุชุฑูุงุช ููููุฑุฏูู
3. ุตุงูู ุงููุดุชุฑูุงุช (ุจุนุฏ ุฎุตู ุงููุฑุชุฌุนุงุช)
4. ุญุณุงุจ ูู ููุฑุฏ

---

## ๐ฏ ุฎุทุฉ ุงูุชูููุฐ

### ุงููุฑุญูุฉ 1: Backend (ูุงุนุฏุฉ ุงูุจูุงูุงุช)
- [ ] ุชุญุฏูุซ `Invoice` model
- [ ] ุฅุถุงูุฉ `original_invoice_id`, `return_reason`, `gold_type`
- [ ] ุฅูุดุงุก migration ููุชุญุฏูุซุงุช
- [ ] ุชุญุฏูุซ validation rules

### ุงููุฑุญูุฉ 2: Backend (API)
- [ ] ุชุญุฏูุซ API endpoints ููููุงุชูุฑ
- [ ] ุฅุถุงูุฉ endpoint ูุฌูุจ ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ ูููุฑุชุฌุน
- [ ] ุฅุถุงูุฉ validation ูููุฑุชุฌุนุงุช
- [ ] ุชุญุฏูุซ ุงููููุฏ ุงููุญุงุณุจูุฉ ููู ููุน

### ุงููุฑุญูุฉ 3: Frontend (POS Section)
- [ ] ุดุงุดุฉ ูุงุชูุฑุฉ ุจูุน
- [ ] ุดุงุดุฉ ุดุฑุงุก ูุณุฑ ูู ุนููู
- [ ] ุดุงุดุฉ ูุฑุชุฌุน ุจูุน (ูุน ุงุฎุชูุงุฑ ูุงุชูุฑุฉ ุฃุตููุฉ)
- [ ] ุดุงุดุฉ ูุฑุชุฌุน ุดุฑุงุก ูุณุฑ (ูุน ุงุฎุชูุงุฑ ูุงุชูุฑุฉ ุฃุตููุฉ)

### ุงููุฑุญูุฉ 4: Frontend (Accounting Section)
- [ ] ุดุงุดุฉ ุดุฑุงุก ูู ููุฑุฏ
- [ ] ุดุงุดุฉ ูุฑุชุฌุน ุดุฑุงุก ูู ููุฑุฏ

### ุงููุฑุญูุฉ 5: ุงูุชูุงุฑูุฑ
- [ ] ุชูุงุฑูุฑ POS
- [ ] ุชูุงุฑูุฑ Accounting
- [ ] ุชูุงุฑูุฑ ุงููุฑุชุฌุนุงุช

---

## โ ุงูููุงุฆุฏ ุงููุชููุนุฉ

1. **ุชูุธูู ุฃูุถู:**
   - ูุตู ูุงุถุญ ุจูู ูุนุงููุงุช ุงูุนููุงุก ูุงูููุฑุฏูู
   - ุณูููุฉ ุงููุตูู ููู ูุณู

2. **ุฏูุฉ ูุญุงุณุจูุฉ:**
   - ุชุชุจุน ุงููุฑุชุฌุนุงุช ุจุดูู ุตุญูุญ
   - ูููุฏ ููููุฉ ุฏูููุฉ ููู ููุน

3. **ุชูุงุฑูุฑ ุดุงููุฉ:**
   - ุตุงูู ุงููุจูุนุงุช ูุงููุดุชุฑูุงุช
   - ุชุญููู ูุณุจุฉ ุงููุฑุชุฌุนุงุช

4. **ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู:**
   - ูุงุฌูุงุช ูููุตูุฉ ุญุณุจ ุงูุฏูุฑ
   - ุนูููุงุช ูุงุถุญุฉ ูููุธูุฉ

---

**ุงูุชุงุฑูุฎ:** 10 ุฃูุชูุจุฑ 2025  
**ุงูุญุงูุฉ:** ๐ ุชุฎุทูุท - ุฌุงูุฒ ููุชูููุฐ  
**ุงูุฃููููุฉ:** ๐ฅ ุนุงููุฉ
