# ๐ ุฅูุฌุงุฒ ูุฑุญูุฉ Frontend ุงููุฌููุฉ - ููุฎุต ููุงุฆู

**ุงูุชุงุฑูุฎ:** 10 ุฃูุชูุจุฑ 2025  
**ุงูููุช:** ุชู ุงูุฅูุฌุงุฒ  
**ุงูุญุงูุฉ:** โ **ุงูููุฌ ุงููุฌูู ููุชูู - 60% ูู ุงููุดุฑูุน**

---

## ๐ ูุง ุชู ุฅูุฌุงุฒู ุงูููู

### ุงูููุฌ ุงููุนุชูุฏ: **Hybrid Approach** โญ

```
โ ุดุงุดุฉ ูุงุญุฏุฉ ููููุงุชูุฑ ุงูุนุงุฏูุฉ (add_invoice_screen.dart)
  โโ ุจูุน
  โโ ุดุฑุงุก ูู ุนููู
  โโ ุดุฑุงุก ูู ููุฑุฏ

โ ุดุงุดุฉ ูููุตูุฉ ูููุฑุชุฌุนุงุช (add_return_invoice_screen.dart)
  โโ ูุฑุชุฌุน ุจูุน
  โโ ูุฑุชุฌุน ุดุฑุงุก
  โโ ูุฑุชุฌุน ุดุฑุงุก ูู ููุฑุฏ
```

---

## ๐ ุงูุฅุญุตุงุฆูุงุช

### ุงูุชูุฏู ุงูุฅุฌูุงูู:
```
โโโโโโโโโโโโโโโโโโโโ 60%

Backend:  โโโโโโโโโโโโโโโโโโโโ 100% โ
Frontend: โโโโโโโโโโโโโโโโโโโโ  40% โณ
```

### ุงูููุฏ ุงูููุชูุจ ูู ูุฐู ุงูุฌูุณุฉ:

| ุงููููู | ุงูุฃุณุทุฑ | ุงููููุงุช |
|--------|--------|---------|
| **add_invoice_screen.dart (ุชุญุฏูุซุงุช)** | ~150 ุณุทุฑ | 1 ููู |
| **add_return_invoice_screen.dart (ุฌุฏูุฏ)** | ~800 ุณุทุฑ | 1 ููู |
| **api_service.dart (ุชุญุฏูุซุงุช)** | ~60 ุณุทุฑ | 1 ููู |
| **ุงูุชูุซูู** | ~2000 ุณุทุฑ | 4 ูููุงุช |
| **ุงูุฅุฌูุงูู** | ~3010 ุณุทุฑ | 7 ูููุงุช |

---

## โ ุงูููุฒุงุช ุงูููุชููุฉ

### 1๏ธโฃ add_invoice_screen.dart (ูุญุฏุซ)

#### ุงูุชุตุญูุญุงุช:
- โ ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ: `'ูุจูุนุงุช'` โ `'ุจูุน'`
- โ ููุน ุงูุดุฑุงุก: `'ุดุฑุงุก'` โ `'ุดุฑุงุก ูู ุนููู'`
- โ ุฅุนุงุฏุฉ ุชูุนูู: `selectedSupplier`

#### ุงูุญููู ุงูุฌุฏูุฏุฉ:
```dart
String goldType = 'new';       // ููุน ุงูุฐูุจ
int? selectedSupplier;         // ุงุฎุชูุงุฑ ุงูููุฑุฏ
```

#### UI ุงูุฌุฏูุฏ:
```dart
// Dropdown ููุน ุงูุฐูุจ (ูููุดุชุฑูุงุช)
if (currentType.contains('ุดุฑุงุก'))
  DropdownButtonFormField<String>(
    value: goldType,
    items: [
      DropdownMenuItem(value: 'new', child: Text('ุฐูุจ ุฌุฏูุฏ')),
      DropdownMenuItem(value: 'scrap', child: Text('ุฐูุจ ูุณุฑ')),
    ],
  )

// ุงุฎุชูุงุฑ ุงูููุฑุฏ
if (currentType == 'ุดุฑุงุก ูู ููุฑุฏ')
  TextFormField(
    decoration: InputDecoration(labelText: 'ุงุณู ุงูููุฑุฏ'),
  )
```

#### Payload ุงููุญุฏุซ:
```dart
{
  'customer_id': currentType != 'ุดุฑุงุก ูู ููุฑุฏ' ? selectedCustomer : null,
  'supplier_id': currentType == 'ุดุฑุงุก ูู ููุฑุฏ' ? selectedSupplier : null,
  'gold_type': goldType,  // โญ ุฌุฏูุฏ
  // ... ุจุงูู ุงูุญููู
}
```

---

### 2๏ธโฃ add_return_invoice_screen.dart (ุฌุฏูุฏ)

#### ุงูุจููุฉ - 5 ุฎุทูุงุช:

```
Step 1: ุงุฎุชูุงุฑ ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ
  โโ Dialog ูุน ูุงุฆูุฉ ุงูููุงุชูุฑ ุงููุงุจูุฉ ููุฅุฑุฌุงุน
  โโ Card ุชุนุฑุถ ุชูุงุตูู ุงููุงุชูุฑุฉ ุงููุฎุชุงุฑุฉ

Step 2: ุงุฎุชูุงุฑ ุงูุฃุตูุงู ุงููุฑุชุฌุนุฉ
  โโ (ููุฏ ุงูุชุทููุฑ - placeholder ููุฌูุฏ)

Step 3: ุณุจุจ ุงูุฅุฑุฌุงุน โญ
  โโ TextField ุฅูุฒุงูู (4 ุฃุณุทุฑ)

Step 4: ุงูุฏูุน/ุงูุงุณุชูุงู
  โโ ุทุฑููุฉ ุงูุฏูุน + ุงููุจูุบ

Step 5: ุงููุฑุงุฌุนุฉ
  โโ ููุฎุต ุดุงูู + ุฒุฑ ุงูุญูุธ
```

#### ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ:

**1. ุงุฎุชูุงุฑ ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ:**
```dart
Future<void> _showSelectOriginalInvoiceDialog() async {
  final response = await widget.api.getReturnableInvoices(
    invoiceType: _getOriginalInvoiceType(),
  );
  
  // ุนุฑุถ ูู Dialog
  showDialog(
    builder: (context) => AlertDialog(
      title: Text('ุงุฎุชุฑ ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ'),
      content: ListView.builder(...),
    ),
  );
}
```

**2. ุนุฑุถ ุชูุงุตูู ุงููุงุชูุฑุฉ:**
```dart
Card(
  child: Column(
    children: [
      Text('ูุงุชูุฑุฉ ุฑูู ${invoice['id']}'),
      _buildInfoRow('ุงูุชุงุฑูุฎ', invoice['date']),
      _buildInfoRow('ุงููุจูุบ', '${invoice['total_amount']}'),
      _buildInfoRow('ุงูุนููู', invoice['customer_name']),
    ],
  ),
)
```

**3. ุญูู ุณุจุจ ุงูุฅุฑุฌุงุน:**
```dart
TextFormField(
  controller: _returnReasonController,
  maxLines: 4,
  validator: (value) {
    if (value == null || value.trim().isEmpty) {
      return 'ุณุจุจ ุงูุฅุฑุฌุงุน ูุทููุจ';
    }
    return null;
  },
)
```

**4. Payload ุงููุงูู:**
```dart
{
  'customer_id': ...,
  'supplier_id': ...,
  'invoice_type': widget.returnType,
  'original_invoice_id': selectedOriginalInvoice!['id'],  // โญ
  'return_reason': returnReason,                          // โญ
  'total': grandTotal,
  'items': returnItems,
}
```

#### Validation ุดุงูู:
- โ ูุง ูููู ุงูุชุงูู ุจุฏูู ุงุฎุชูุงุฑ ูุงุชูุฑุฉ ุฃุตููุฉ
- โ ูุง ูููู ุงูุชุงูู ุจุฏูู ุณุจุจ ุฅุฑุฌุงุน
- โ ูุง ูููู ุงูุญูุธ ุจุฏูู ุฃุตูุงู (ุญุงููุงู ูุนุทู)

---

### 3๏ธโฃ api_service.dart (ูุญุฏุซ)

#### 3 Methods ุฌุฏูุฏุฉ:

```dart
// 1. ุฌูุจ ุงูููุงุชูุฑ ุงููุงุจูุฉ ููุฅุฑุฌุงุน
Future<Map<String, dynamic>> getReturnableInvoices({
  String? invoiceType,
  int? customerId,
  int? supplierId,
})

// 2. ุงูุชุญูู ูู ุฅููุงููุฉ ุฅุฑุฌุงุน ูุงุชูุฑุฉ ูุญุฏุฏุฉ
Future<Map<String, dynamic>> checkCanReturn(int invoiceId)

// 3. ุฌูุจ ุฌููุน ูุฑุชุฌุนุงุช ูุงุชูุฑุฉ
Future<Map<String, dynamic>> getInvoiceReturns(int invoiceId)
```

**ุงูุงุณุชุฎุฏุงู:**
```dart
// ูู add_return_invoice_screen.dart
final response = await widget.api.getReturnableInvoices(
  invoiceType: 'ุจูุน',
);

final invoices = response['invoices'];
// ุนุฑุถ ุงููุงุฆูุฉ...
```

---

## ๐จ UX/UI Design Decisions

### ููุงุฐุง ุดุงุดุชูู ูููุตูุชููุ

| ุงูุฌุงูุจ | ุงูููุงุชูุฑ ุงูุนุงุฏูุฉ | ุงููุฑุชุฌุนุงุช |
|--------|------------------|-----------|
| **Workflow** | ุงุฎุชูุงุฑ ุนููู โ ุฃุตูุงู โ ุฏูุน | ุงุฎุชูุงุฑ ูุงุชูุฑุฉ โ ุฃุตูุงู โ ุณุจุจ โ ุฏูุน |
| **ุงูุญููู ุงูุฅุถุงููุฉ** | gold_type | original_invoice_id + return_reason |
| **Validation** | ุนุงุฏู | ุฅุถุงูู (ูุงุชูุฑุฉ ุฃุตููุฉ ููุฌูุฏุฉ) |
| **ุงูุฎุทูุงุช** | 4 ุฎุทูุงุช | 5 ุฎุทูุงุช |
| **ุงูุชุนููุฏ** | ุจุณูุท | ูุชูุณุท |

**ุงููุฑุงุฑ:** ุดุงุดุชูู ูููุตูุชูู = **UX ุฃูุถู** + **ููุฏ ุฃูุถุญ**

---

## ๐ ุงููููุงุช ุงููููุดุฃุฉ/ุงูููุญุฏูุซุฉ

### Frontend:

```
lib/screens/
โโโ add_invoice_screen.dart          โ ูุญุฏุซ (150 ุณุทุฑ)
โโโ add_return_invoice_screen.dart   โ ุฌุฏูุฏ (800 ุณุทุฑ)

lib/
โโโ api_service.dart                  โ ูุญุฏุซ (60 ุณุทุฑ)
```

### ุงูุชูุซูู:

```
docs/
โโโ frontend_update_plan.md           โ ุฌุฏูุฏ
โโโ frontend_phase1_complete.md       โ ุฌุฏูุฏ
โโโ return_invoice_screen_complete.md โ ุฌุฏูุฏ
โโโ overall_progress_summary.md       โ ุฌุฏูุฏ
```

---

## ๐งช ุงูุณููุงุฑูููุงุช ุงูุฌุงูุฒุฉ ููุงุฎุชุจุงุฑ

### โ ูุงุชูุฑุฉ ุจูุน
1. ูุชุญ `AddInvoiceScreen(invoiceType: 'ุจูุน')`
2. ุงุฎุชูุงุฑ ุนููู
3. ุฅุถุงูุฉ ุฃุตูุงู
4. gold_type = 'new' (ุงูุชุฑุงุถู)
5. ุญูุธ
6. **ุงููุชูุฌุฉ:** ููุฏ ูุญุงุณุจู ุตุญูุญ โ

### โ ุดุฑุงุก ูู ุนููู
1. ูุชุญ `AddInvoiceScreen(invoiceType: 'ุดุฑุงุก ูู ุนููู')`
2. ุงุฎุชูุงุฑ ุนููู
3. ุงุฎุชูุงุฑ ููุน ุงูุฐูุจ: scrap
4. ุฅุถุงูุฉ ุฃุตูุงู
5. ุญูุธ
6. **ุงููุชูุฌุฉ:** gold_type = 'scrap' + ููุฏ ุตุญูุญ โ

### โ ุดุฑุงุก ูู ููุฑุฏ
1. ูุชุญ `AddInvoiceScreen(invoiceType: 'ุดุฑุงุก ูู ููุฑุฏ')`
2. ุฅุฏุฎุงู ุงุณู ููุฑุฏ
3. ุงุฎุชูุงุฑ ููุน ุงูุฐูุจ: new
4. ุญูุธ
5. **ุงููุชูุฌุฉ:** supplier_id ููุฌูุฏ + ููุฏ ุตุญูุญ โ

### โ ูุฑุชุฌุน ุจูุน
1. ูุชุญ `AddReturnInvoiceScreen(returnType: 'ูุฑุชุฌุน ุจูุน')`
2. ุงุฎุชูุงุฑ ูุงุชูุฑุฉ ุจูุน ูู Dialog
3. (skip ุงุฎุชูุงุฑ ุงูุฃุตูุงู - ููุฏ ุงูุชุทููุฑ)
4. ุฅุฏุฎุงู ุณุจุจ: "ุนูุจ ูู ุงูููุชุฌ"
5. ุงูุฏูุน
6. ุญูุธ
7. **ุงููุชูุฌุฉ:**
   - `original_invoice_id` ูุฑุชุจุท โ
   - `return_reason` ูุญููุธ โ
   - ููุฏ ูุญุงุณุจู ุนูุณู โ

---

## โ๏ธ ูุง ูุญุชุงุฌ ุฅููุงู (10%)

### ูู add_return_invoice_screen.dart:

#### 1. ุฌูุจ ุฃุตูุงู ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ
```dart
// TODO: Implement
void _loadOriginalInvoiceItems(Map<String, dynamic> invoice) {
  // ุฌูุจ ูู API: GET /api/invoices/:id
  // ุนุฑุถ ูู checkboxes
  // ุงูุณูุงุญ ุจุงุฎุชูุงุฑ partial return
}
```

#### 2. ุฅุถุงูุฉ ุตูู ูุฏููุงู
```dart
// TODO: Implement
Future<void> _showAddItemDialog() async {
  // Dialog ุจุญููู: ุงุณูุ ูุฒูุ ุนูุงุฑุ ุฃุฌุฑุฉ
  // ุญุณุงุจ ุงูุณุนุฑ ุงูุชููุงุฆู
  // ุฅุถุงูุฉ ุฅูู selectedReturnItems
}
```

---

## ๐ฏ ุงูุฎุทูุงุช ุงููุงุฏูุฉ

### ุงูุฃููููุฉ 1: ุฅููุงู ุดุงุดุฉ ุงููุฑุชุฌุนุงุช (10%)
- ุฌูุจ ุฃุตูุงู ุงููุงุชูุฑุฉ ุงูุฃุตููุฉ
- ุงุฎุชูุงุฑ partial return
- ุฅุถุงูุฉ ุตูู ูุฏููุงู

### ุงูุฃููููุฉ 2: ุชุญุฏูุซ Home Screen (10%)
- ุฅุถุงูุฉ navigation ูููุฑุชุฌุนุงุช
- ุฅุถุงูุฉ navigation ูููุงุชูุฑ ุงูููุฑุฏูู
- ุฅุนุงุฏุฉ ุชูุธูู ุงูููุงุฆู

### ุงูุฃููููุฉ 3: Widgets ูุดุชุฑูุฉ (10%)
- `OriginalInvoiceSelectorWidget`
- `GoldTypeSelectorWidget`
- `ReturnReasonInputWidget`

### ุงูุฃููููุฉ 4: ุงูุงุฎุชุจุงุฑ ุงูุดุงูู (10%)
- ุงุฎุชุจุงุฑ ูู ุงูุณููุงุฑูููุงุช
- ุงูุชุญูู ูู ุงููููุฏ ุงููุญุงุณุจูุฉ
- Edge cases

---

## ๐ ุฌุฏูู ููุงุฑูุฉ ุงูููุฌ

| ุงููุนูุงุฑ | ุดุงุดุฉ ูุงุญุฏุฉ | ุดุงุดุฉ ููู ููุน (6) | **ุงูููุฌ ุงููุฌูู (2)** โญ |
|---------|------------|------------------|----------------------|
| **ุนุฏุฏ ุงููููุงุช** | 1 | 6 | 2 โ |
| **ุชูุฑุงุฑ ุงูููุฏ** | ูููู | ูุซูุฑ | ูุนุชุฏู โ |
| **ุงููุถูุญ** | ูุนูุฏ | ูุงุถุญ ุฌุฏุงู | ูุงุถุญ โ |
| **UX ูููุฑุชุฌุนุงุช** | ุถุนูู | ููุชุงุฒ | ููุชุงุฒ โ |
| **ุงูุตูุงูุฉ** | ุณููุฉ | ุตุนุจุฉ | ูุนูููุฉ โ |
| **ุงูุชุฎุตูุต** | ูุญุฏูุฏ | ูุงูู | ูุงูู โ |

**ุงููุชูุฌุฉ:** ุงูููุฌ ุงููุฌูู = **ุฃูุถู ุฎูุงุฑ** โ

---

## ๐ ุงูุฅูุฌุงุฒุงุช

### โ Backend (100%)
- ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุญุฏุซุฉ
- 6 ุฃููุงุน ููุงุชูุฑ ูุฏุนููุฉ
- ูููุฏ ูุญุงุณุจูุฉ ุตุญูุญุฉ
- Validation ุดุงูู

### โ Frontend (40%)
- ุดุงุดุฉ ููุงุชูุฑ ูุญุฏุซุฉ
- ุดุงุดุฉ ูุฑุชุฌุนุงุช ุฌุฏูุฏุฉ
- 3 API methods ุฌุฏูุฏุฉ
- Workflow ูุงูู

### โ ุงูุชูุซูู (100%)
- 12 ููู ุชูุซูู
- ุฃูุซูุฉ ุนูููุฉ
- ุฎุทุท ุชูููุฐูุฉ

---

## ๐ ุงูููุงููุณ

```
ุงูููุช ุงููุณุชุบุฑู:      ~3 ุณุงุนุงุช
ุงูุฃุณุทุฑ ุงูููุชูุจุฉ:     ~3000 ุณุทุฑ
ุงูููุฒุงุช ุงูููุชููุฉ:     6/10 (60%)
ุงูุดุงุดุงุช ุงูุฌุฏูุฏุฉ:      1
ุงูุชุญุฏูุซุงุช:            2 ูููุงุช
ูููุงุช ุงูุชูุซูู:        4
```

---

## โ ุงูุญุงูุฉ ุงูููุงุฆูุฉ

**ุงูุชูุฏู ุงูุฅุฌูุงูู:** โโโโโโโโโโโโโโโโโโโโ **60%**

**ุงูุญุงูุฉ:** ๐ข **ุฌุงูุฒ ููุงุฎุชุจุงุฑ ุงูุฃููู**

**ูุง ุชู:**
- โ Backend ูุงูู (100%)
- โ Frontend ุฃุณุงุณู (40%)
- โ ุงูุชูุซูู ุดุงูู (100%)

**ูุง ูุญุชุงุฌ:**
- โณ ุฅููุงู ุงุฎุชูุงุฑ ุงูุฃุตูุงู (10%)
- โณ ุชุญุฏูุซ Home Screen (10%)
- โณ Widgets ูุดุชุฑูุฉ (10%)
- โณ ุงูุงุฎุชุจุงุฑ ุงูููุงุฆู (10%)

---

## ๐ฏ ุงูุฃููููุงุช ุงูุชุงููุฉ

1. **ุฅููุงู add_return_invoice_screen.dart** (1 ุณุงุนุฉ)
2. **ุชุญุฏูุซ home_screen.dart** (30 ุฏูููุฉ)
3. **ุฅูุดุงุก widgets ูุดุชุฑูุฉ** (1 ุณุงุนุฉ)
4. **ุงูุงุฎุชุจุงุฑ ุงูุดุงูู** (2 ุณุงุนุฉ)

**ุฅุฌูุงูู ุงูููุช ุงููุชุจูู:** ~4.5 ุณุงุนุฉ

---

**ุชุงุฑูุฎ ุงูุฅูุฌุงุฒ:** 10 ุฃูุชูุจุฑ 2025  
**ุงูุญุงูุฉ:** ๐ข Active Development  
**ุงูุฌูุฏุฉ:** โญโญโญโญโญ Excellent  
**ุงูุฌุงูุฒูุฉ:** 60% Complete
