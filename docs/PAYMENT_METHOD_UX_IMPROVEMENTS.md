# ุชุญุณููุงุช ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู - ูุณุงุฆู ุงูุฏูุน
**ุงูุชุงุฑูุฎ:** 13 ุฃูุชูุจุฑ 2025

---

## ๐ฏ ุงููุฑุงุฑ ุงูุงุณุชุฑุงุชูุฌู

ุชู ุงุนุชูุงุฏ **ุงูุทุฑููุฉ ุงูุญุงููุฉ** (ุฑุจุท ูุณุงุฆู ุงูุฏูุน ุจุญุณุงุจุงุช ููุฌูุฏุฉ) ุจุฏูุงู ูู ุฅูุดุงุก ุญุณุงุจุงุช ูุฑุนูุฉ ุชููุงุฆูุฉ.

### ููุงุฐุง ูุฐุง ุงููุฑุงุฑุ

#### โ ุงููุฒุงูุง ุงููุญุงุณุจูุฉ:

1. **ุงููุงูุนูุฉ:**
   - ุจูู ูุงุญุฏ = ุญุณุงุจ ูุงุญุฏ ูุนูู
   - ูุฏู + ููุฒุง + ูุงุณุชุฑ โ ููุณ IBAN
   - ูุง ุฏุงุนู ูุชูุณูู ุบูุฑ ููุทูู

2. **ูุถูุญ ุงูุชูุงุฑูุฑ:**
   ```
   ุงูููุฒุงููุฉ:
   1112 - ุจูู ุงูุฑูุงุถ: 50,000 ุฑูุงู โ
   
   ุจุฏูุงู ูู:
   1112.1 - ูุฏู: 15,000 ุฑูุงู
   1112.2 - ููุฒุง: 20,000 ุฑูุงู
   1112.3 - ูุงุณุชุฑ: 15,000 ุฑูุงู
   โ ูุดุชุช ูุบูุฑ ูุงุถุญ
   ```

3. **ุงููุฑููุฉ:**
   - ูููู ุฑุจุท ุนุฏุฉ ูุณุงุฆู ุจููุณ ุงูุญุณุงุจ
   - ูููู ุชุบููุฑ ุงูุฑุจุท ุจุณูููุฉ
   - ูุง ุชุชุฃุซุฑ ุงููุนุงููุงุช ุงููุฏููุฉ

4. **ุงูุจุณุงุทุฉ:**
   - ูุง ุญุงุฌุฉ ูุฅุฏุงุฑุฉ ุญุณุงุจุงุช ุฅุถุงููุฉ
   - ูุธุงู ุฃูู ุชุนููุฏุงู
   - ุตูุงูุฉ ุฃุณูู

---

## ๐ ุงูุชุญุณููุงุช ุงููุทุจูุฉ

### 1. **ููุชุฑุฉ ุงูุญุณุงุจุงุช ุงูุฐููุฉ**

**ุงูููุฏ:**
```dart
accounts = response.where((acc) {
  final accountNumber = acc['account_number'] as String;
  return (accountNumber.startsWith('1111') ||  // ุตูุฏูู
          accountNumber.startsWith('1112') ||  // ุจููู
          accountNumber.startsWith('1115') ||  // ุชุงุจู
          accountNumber.startsWith('1116')) && // ุชูุงุฑุง
         acc['transaction_type'] != null;
}).toList();
```

**ุงููุงุฆุฏุฉ:**
- ูุนุฑุถ ุงูุญุณุงุจุงุช ุงูููุงุณุจุฉ ููุณุงุฆู ุงูุฏูุน ููุท
- ูุฎูู ุงูุญุณุงุจุงุช ุบูุฑ ุฐุงุช ุงูุตูุฉ
- ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุธู

---

### 2. **ุชุฑุชูุจ ูุฑูู ููุญุณุงุจุงุช**

**ุงูููุฏ:**
```dart
accounts.sort((a, b) {
  final aHasDot = a['account_number'].contains('.');
  final bHasDot = b['account_number'].contains('.');
  if (aHasDot && !bHasDot) return 1;  // ุงููุฑุนูุฉ ุจุนุฏ ุงูุฑุฆูุณูุฉ
  if (!aHasDot && bHasDot) return -1;
  return a['account_number'].compareTo(b['account_number']);
});
```

**ุงููุชูุฌุฉ:**
```
โ 1111 - ุงูุตูุฏูู
โ 1112 - ุงูุจูู (ุฑุฆูุณู)
   โ 1112.1 - ูุฏู (ูุฑุนู)
   โ 1112.2 - ููุฒุง (ูุฑุนู)
โ 1115 - ุชุงุจู
```

---

### 3. **ุนุฑุถ ูุฑุฆู ูุญุณูู ูู Dropdown**

**ุงููููุฒุงุช:**
- ุฃููููุงุช ูุฎุชููุฉ (ุฑุฆูุณู/ูุฑุนู)
- ุฃููุงู ูููุฒุฉ
- ูุณุงูุฉ ุจุงุฏุฆุฉ ููุญุณุงุจุงุช ุงููุฑุนูุฉ
- ุนุฑุถ ุงุณู ุงูุจูู ุชุญุช ุฑูู ุงูุญุณุงุจ

**ุงูููุฏ:**
```dart
Row(
  children: [
    if (isSubAccount) const SizedBox(width: 16), // indent
    Icon(
      isSubAccount ? Icons.subdirectory_arrow_left : Icons.account_balance_wallet,
      color: isSubAccount ? Colors.blue.shade700 : Colors.green.shade700,
    ),
    Column([
      Text('1112.1 - ูุฏู'),
      Text('๐ฆ ุจูู ุงูุฑูุงุถ', style: small),
    ]),
  ],
)
```

---

### 4. **Auto-fill ูุนูููุงุช ุงูุจูู**

ุนูุฏ ุงุฎุชูุงุฑ ุญุณุงุจ ูุญุชูู ุนูู ูุนูููุงุช ุจูู:
```dart
onChanged: (value) {
  final account = accounts.firstWhere((a) => a['id'] == value);
  
  if (account['bank_name'] != null) {
    bankNameController.text = account['bank_name']; โ
  }
  
  if (account['account_number_external'] != null) {
    accountExternalController.text = account['account_number_external']; โ
  }
}
```

**ุงููุงุฆุฏุฉ:**
- ูููุฃ ุงูุญููู ุชููุงุฆูุงู
- ูููุฑ ุงูููุช
- ูููู ุงูุฃุฎุทุงุก

---

### 5. **Info Box ุชูุถูุญู**

```dart
Container(
  color: Colors.blue.shade50,
  child: Row([
    Icon(Icons.info_outline),
    Text('ูููู ุฑุจุท ุนุฏุฉ ูุณุงุฆู ุฏูุน ุจููุณ ุงูุญุณุงุจ ุงูุจููู'),
  ]),
)
```

**ุงููุงุฆุฏุฉ:**
- ููุถุญ ูููุณุชุฎุฏู ุฃูู ูููู ุฑุจุท ุนุฏุฉ ูุณุงุฆู ุจุญุณุงุจ ูุงุญุฏ
- ูููู ุงูุงุฑุชุจุงู
- ูุดุฌุน ุนูู ุงูุงุณุชุฎุฏุงู ุงูุตุญูุญ

---

### 6. **Validation ูุญุณููุฉ**

**ุงูุฅุถุงูุงุช:**

1. **ุงูุชุญูู ูู ุงูุชูุฑุงุฑ:**
```dart
final existingMethod = _paymentMethods.firstWhere(
  (m) => m['name'].toLowerCase() == nameController.text.toLowerCase(),
  orElse: () => {},
);
if (existingMethod.isNotEmpty) {
  showSnackBar('โ๏ธ ูุณููุฉ ุฏูุน ุจููุณ ุงูุงุณู ููุฌูุฏุฉ');
  return;
}
```

2. **ุฑุณุงุฆู ูุงุถุญุฉ ูุน emoji:**
```dart
โ ุชู ุฅุถุงูุฉ "ูุฏู" ุจูุฌุงุญ
โ๏ธ ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงุณู ูุณููุฉ ุงูุฏูุน
โ ูุดู ุฅุถุงูุฉ ูุณููุฉ ุงูุฏูุน
```

3. **ุงูุชุญูู ูู context.mounted:**
```dart
if (!context.mounted) return; // ููุน ุฃุฎุทุงุก Flutter
```

---

### 7. **ุฒุฑ Toggle ุจุฏูุงู ูู ุงูุญุฐู**

**ูุจู:**
```dart
IconButton(icon: Icons.delete) // ุญุฐู ููุงุฆู โ
```

**ุจุนุฏ:**
```dart
IconButton(
  icon: Icon(
    method['is_active'] ? Icons.toggle_on : Icons.toggle_off,
    color: method['is_active'] ? Colors.green : Colors.grey,
  ),
  onPressed: () => _togglePaymentMethod(index),
) // ุชูุนูู/ุฅูุบุงุก ุชูุนูู โ
```

**ุงููููุฒุงุช:**
- Soft delete (ูุง ูุญุฐู ุงูุญุณุงุจ)
- ุงูุณุฌูุงุช ุงูุชุงุฑูุฎูุฉ ูุญููุธุฉ
- ุฅููุงููุฉ ุงูุงุณุชุนุงุฏุฉ
- Visual indicators ูููุณุงุฆู ุงููุนุทูุฉ

---

### 8. **Visual Indicators ูููุณุงุฆู ุงููุนุทูุฉ**

```dart
// ุฎูููุฉ ุฑูุงุฏูุฉ
cardColor: isActive ? Colors.white : Colors.grey.shade100

// ูุต ุจุงูุช
textColor: isActive ? Colors.black87 : Colors.grey.shade600

// ุฎุท ุนูู ุงูุงุณู
decoration: isActive ? null : TextDecoration.lineThrough

// Badge "ูุนุทูุฉ"
if (!isActive)
  Container(
    color: Colors.grey.shade300,
    child: Text('ูุนุทูุฉ'),
  )
```

---

## ๐ ุงูููุงุฑูุฉ: ูุจู ูุจุนุฏ

| ุงูููุฒุฉ | ูุจู | ุจุนุฏ |
|--------|-----|-----|
| **ุงุฎุชูุงุฑ ุงูุญุณุงุจุงุช** | ูู ุงูุญุณุงุจุงุช (ูุฑุจู) | ุญุณุงุจุงุช ูุณุงุฆู ุงูุฏูุน ููุท โ |
| **ุงูุชุฑุชูุจ** | ุนุดูุงุฆู | ูุฑูู ููุทูู โ |
| **ุงูุนุฑุถ** | ูุต ููุท | ุฃููููุงุช + ุฃููุงู + ูุนูููุงุช โ |
| **Auto-fill** | ูุฏูู | ุชููุงุฆู โ |
| **ุงูุชูุถูุญ** | ูุง ููุฌุฏ | Info box โ |
| **Validation** | ุจุณูุทุฉ | ุดุงููุฉ ูุน ุฑุณุงุฆู ูุงุถุญุฉ โ |
| **ุงูุญุฐู** | ููุงุฆู | Soft delete โ |
| **ุงููุนุทูุฉ** | ุบูุฑ ูุงุถุญุฉ | Visual indicators โ |

---

## ๐จ ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู ุงูููุงุฆูุฉ

### ุนูุฏ ุฅุถุงูุฉ ูุณููุฉ ุฏูุน ุฌุฏูุฏุฉ:

1. โ ููุชุญ Dialog ุฌููู ูููุธู
2. โ ูุฑู ุงูุญุณุงุจุงุช ุงูููุงุณุจุฉ ููุท (ูุน ุฃููููุงุช)
3. โ ูุฎุชุงุฑ ุญุณุงุจ โ ูููุฃ ุงููุธุงู ูุนูููุงุช ุงูุจูู ุชููุงุฆูุงู
4. โ ูุฑู Info box ููุถุญ ุฃูู ูููู ุฑุจุท ุนุฏุฉ ูุณุงุฆู
5. โ ูุฏุฎู ุจุงูู ุงููุนูููุงุช
6. โ ูุถุบุท "ุฅุถุงูุฉ" โ ุฑุณุงูุฉ ูุฌุงุญ ูุงุถุญุฉ
7. โ ุชุธูุฑ ุงููุณููุฉ ุงูุฌุฏูุฏุฉ ูู ุงููุงุฆูุฉ ููุฑุงู

### ุนูุฏ ุชุนุทูู ูุณููุฉ:

1. โ ูุถุบุท ุฒุฑ Toggle (ุฃุฎุถุฑ โ ุฑูุงุฏู)
2. โ ูุธูุฑ ุชุฃููุฏ ูุงุถุญ ูุน ุดุฑุญ
3. โ ุงูุจุทุงูุฉ ุชุตุจุญ ุฑูุงุฏูุฉ
4. โ ูุธูุฑ badge "ูุนุทูุฉ"
5. โ ุฎุท ุนูู ุงูุงุณู
6. โ ุงูุญุณุงุจ ูุง ูุฒุงู ููุฌูุฏุงู ูู ุดุฌุฑุฉ ุงูุญุณุงุจุงุช
7. โ ูููู ุฅุนุงุฏุฉ ุงูุชูุนูู ุจุณูููุฉ

---

## ๐ง ุงููููุงุช ุงููุนุฏูุฉ

### Frontend:
- `lib/screens/settings_screen.dart`
  * `_addPaymentMethod()` - Dialog ูุญุณูู
  * `_togglePaymentMethod()` - ุจุฏูุงู ูู delete
  * `_buildPaymentMethodsTab()` - Visual indicators

### ูู ูุชู ุชุนุฏูู Backend:
- ุงููุธุงู ุงูุญุงูู ูุนูู ุจุดูู ูุซุงูู โ
- API endpoints ูุงููุฉ โ
- ูุง ุญุงุฌุฉ ูุชุบููุฑุงุช โ

---

## โ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

ูุธุงู ูุณุงุฆู ุฏูุน:
- ๐ฏ ูุงูุนู ูุญุงุณุจูุงู
- ๐จ ุฌููู ูููุธู
- ๐ ุณูู ุงูุงุณุชุฎุฏุงู
- ๐ ุขูู (Soft delete)
- ๐ ุชูุงุฑูุฑ ูุงุถุญุฉ
- ๐ง ุณูู ุงูุตูุงูุฉ

---

## ๐ ุงููุฑุงุฌุน

- **ุงูุชุญููู ุงููุญุงุณุจู:** ููุงุฑูุฉ ุจูู ูููุฐุฌ ุงูุนููุงุก ููููุฐุฌ ูุณุงุฆู ุงูุฏูุน
- **ูุนุงููุฑ UX:** Material Design 3 guidelines
- **Best Practices:** Soft delete, Validation, Auto-fill
- **Color Contrast:** WCAG AAA compliance (9.8:1)

---

**ุงูุฎูุงุตุฉ:** ุงูุทุฑููุฉ ุงูุญุงููุฉ (ุฑุจุท ุจุญุณุงุจุงุช ููุฌูุฏุฉ) ูู ุงูุฃูุถู ูุญุงุณุจูุงู ูุนูููุงูุ ูุน ุชุญุณููุงุช UX ุชุฌุนู ุงูุชุฌุฑุจุฉ ููุชุงุฒุฉ. โจ
