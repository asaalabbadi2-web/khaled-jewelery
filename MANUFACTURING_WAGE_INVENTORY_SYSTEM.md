# ูุธุงู ูุฎุฒูู ุฃุฌูุฑ ุงููุตูุนูุฉ - ุฏููู ุงูุชูููุฐ

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชูููุฐ ูุธุงู ูุญุงุณุจู ูุชูุฏู ูุชุชุจุน ุฃุฌูุฑ ุงููุตูุนูุฉ ููุฎุฒูู ูุณุชููุ ุจุฏูุงู ูู ูุนุงูุฌุชูุง ููุตุฑูู ุฃู ุฅูุฑุงุฏ ูุจุงุดุฑ.

---

## ๐ฏ ุงููุฏู ูู ุงููุธุงู

### ุงููุดููุฉ ุงูุณุงุจูุฉ:
- ุฃุฌูุฑ ุงููุตูุนูุฉ ูุงูุช ุชูุฏุฑุฌ ูุจุงุดุฑุฉ ุถูู ุงูุฅูุฑุงุฏุงุช ุนูุฏ ุงูุจูุน
- ูุง ุชูุฌุฏ ุทุฑููุฉ ูุชุชุจุน ุฑุตูุฏ ุงููุตูุนูุฉ ุงููุชุงุญ
- ุตุนูุจุฉ ูู ุญุณุงุจ ุงูุฑุจุญ ุงูุญูููู ูููุตูุนูุฉ

### ุงูุญู ุงูุฌุฏูุฏ:
- **ูุตู ุงููุตูุนูุฉ** ูู ุญุณุงุจ ูุฎุฒูู ูุณุชูู (1340)
- **ุชุชุจุน ุฏููู** ูุฑุตูุฏ ุงููุตูุนูุฉ ุงููุชุงุญ
- **ุญุณุงุจ ุตุญูุญ** ููุชูููุฉ ูุงูุฑุจุญ

---

## ๐๏ธ ุงููููู ุงููุญุงุณุจู

### 1๏ธโฃ ุงูุญุณุงุจ ุงูุฌุฏูุฏ

```
1340 - ูุฎุฒูู ุฃุฌูุฑ ุงููุตูุนูุฉ
โโโ ุงูููุน: ุฃุตู (Asset)
โโโ ุงูุชุตููู: ูุฎุฒูู
โโโ ุงููุญุฏุฉ: ุฑูุงู ุณุนูุฏู
โโโ ุงูุบุฑุถ: ุชุชุจุน ุฑุตูุฏ ุฃุฌูุฑ ุงููุตูุนูุฉ
```

### 2๏ธโฃ ุฏูุฑุฉ ุงููุตูุนูุฉ ุงููุญุงุณุจูุฉ

```mermaid
graph LR
    A[ุดุฑุงุก] -->|ุฅุถุงูุฉ| B[ูุฎุฒูู ุงููุตูุนูุฉ 1340]
    B -->|ุงุณุชููุงู| C[ุจูุน ููุนููู]
    C -->|ุชูููุฉ| D[ุชูููุฉ ุงููุจูุนุงุช 50]
```

---

## ๐ ุงููููุฏ ุงููุญุงุณุจูุฉ

### 1. ุนูุฏ ุดุฑุงุก (ุฅุถุงูุฉ ุงููุตูุนูุฉ)

**ูุซุงู:** ุดุฑุงุก 100 ุฌุฑุงู ุฐูุจ + 500 ุฑูุงู ูุตูุนูุฉ

```
ุงูููุฏ:
ูู ุญู/ ูุฎุฒูู ุฐูุจ ุนูุงุฑ 21 (1310)        45,367 ุฑูุงู
ูู ุญู/ ูุฎุฒูู ุฃุฌูุฑ ุงููุตูุนูุฉ (1340)          500 ุฑูุงู
    ุฅูู ุญู/ ุงูููุฑุฏ                        45,867 ุฑูุงู
```

**ุงูููุฏ ุงูููุทุจู:**
```python
# ูู routes.py - ูุณู ุดุฑุงุก
wage_inventory_account_id = get_account_id_by_number('1340')

if wage_cash > 0:
    create_dual_journal_entry(
        journal_entry_id=journal_entry.id,
        account_id=wage_inventory_account_id,
        cash_debit=round(wage_cash, 2),
        description="ุฅุถุงูุฉ ุฃุฌูุฑ ูุตูุนูุฉ ูููุฎุฒูู"
    )
```

---

### 2. ุนูุฏ ุงูุจูุน (ุงุณุชููุงู ุงููุตูุนูุฉ)

**ูุซุงู:** ุจูุน 10 ุฌุฑุงู (10% ูู ุงููุฎุฒูู) โ ุงุณุชููุงู 50 ุฑูุงู ูุตูุนูุฉ

```
ุงูููุฏ:
ูู ุญู/ ุชูููุฉ ุงููุจูุนุงุช (50)              50 ุฑูุงู
    ุฅูู ุญู/ ูุฎุฒูู ุฃุฌูุฑ ุงููุตูุนูุฉ (1340)  50 ุฑูุงู
```

**ุงูููุฏ ุงูููุทุจู:**
```python
# ูู routes.py - ูุณู ุงูุจูุน
if total_wage_cash_for_cost > 0:
    # ุงุณุชููุงู ูู ุงููุฎุฒูู
    create_dual_journal_entry(
        journal_entry_id=journal_entry.id,
        account_id=cost_of_sales_acc_id,
        cash_debit=round(total_wage_cash_for_cost, 2),
        description="ุงุณุชููุงู ุฃุฌูุฑ ุงููุตูุนูุฉ"
    )
    
    create_dual_journal_entry(
        journal_entry_id=journal_entry.id,
        account_id=wage_inventory_account_id,
        cash_credit=round(total_wage_cash_for_cost, 2),
        description="ุฎุตู ูู ูุฎุฒูู ุฃุฌูุฑ ุงููุตูุนูุฉ"
    )
```

---

## ๐ ุงูุชุญููู ุงููุฒูู

### ุงููุงุนุฏุฉ ุงูุฐูุจูุฉ ูููุตูุนูุฉ:

```
ุงููุตูุนูุฉ ุงููุฒููุฉ = ุงููุตูุนูุฉ ุงูููุฏูุฉ รท ุงูุณุนุฑ ุงููุจุงุดุฑ
```

**ูุซุงู:**
- ุงููุตูุนูุฉ: 500 ุฑูุงู
- ุงูุณุนุฑ ุงููุจุงุดุฑ (21 ุนูุงุฑ): 453.67 ุฑูุงู/ุฌุฑุงู
- ุงููุตูุนูุฉ ุงููุฒููุฉ: 500 รท 453.67 = **1.102 ุฌุฑุงู**

**ุงูููุฏ ุงูููุทุจู:**
```python
# ุชุญููู ุงููุตูุนูุฉ ุฅูู ูุฒู
wage_weight_equivalent = (
    total_wage_cash / direct_gold_price_main
) if direct_gold_price_main > 0 else 0

# ุงูุชูููุฉ ุงููุฒููุฉ = ุงููุฒู ุงููุนูู + ุงููุตูุนูุฉ ุงููุฒููุฉ
karat_weight_cost = weight + (wage_weight_equivalent * karat_proportion)
```

---

## โ ุงูุชุนุฏููุงุช ุงูููููุฐุฉ

### 1. ุฅูุดุงุก ุงูุญุณุงุจ (models.py)
```sql
INSERT INTO accounts (
    account_number, 
    name, 
    type, 
    transaction_type
) VALUES (
    '1340',
    'ูุฎุฒูู ุฃุฌูุฑ ุงููุตูุนูุฉ',
    'asset',
    'cash'
);
```

### 2. ุชุญุฏูุซ ุงูุฎุฑูุทุฉ ุงูุงูุชุฑุงุถูุฉ (routes.py)
```python
DEFAULT_ACCOUNTS = {
    # ...
    'manufacturing_wage_inventory': 1340,
    # ...
}
```

### 3. ุชุนุฏูู ูุงุชูุฑุฉ ุงูุดุฑุงุก (routes.py)
- ูุตู ุงููุตูุนูุฉ ุนู ูููุฉ ุงูุฐูุจ
- ุฅุถุงูุชูุง ูุญุณุงุจ 1340 ุจุฏูุงู ูู ุงููุฎุฒูู ุงูุนุงู

### 4. ุชุนุฏูู ูุงุชูุฑุฉ ุงูุจูุน (routes.py)
- ุงุณุชููุงู ุงููุตูุนูุฉ ูู 1340
- ุชุญููููุง ูุฒููุงู ุจุงุณุชุฎุฏุงู ุงูุณุนุฑ ุงููุจุงุดุฑ
- ุฅุถุงูุชูุง ูุชูููุฉ ุงููุจูุนุงุช

---

## ๐ ุงูููุงุฆุฏ ุงููุญุงุณุจูุฉ

### 1. ุฏูุฉ ุงูุชูููุฉ
- **ูุจู:** ุงูุชูููุฉ = ูุฒู ร ูุชูุณุท ุณุนุฑ ุงูุดุฑุงุก
- **ุจุนุฏ:** ุงูุชูููุฉ = (ูุฒู ร ูุชูุณุท) + ุงููุตูุนูุฉ ุงููุณุชูููุฉ

### 2. ุชุชุจุน ุงูุฑุตูุฏ
```
ุฑุตูุฏ 1340 = ุงููุตูุนูุฉ ุงููุดุชุฑุงุฉ - ุงููุตูุนูุฉ ุงููุจุงุนุฉ
```

### 3. ุงูุฑุจุญ ุงูุญูููู
```
ุงูุฑุจุญ = (ุงูุฅูุฑุงุฏ) - (ุชูููุฉ ุงูุฐูุจ + ุชูููุฉ ุงููุตูุนูุฉ)
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### ุณููุงุฑูู ุงูุงุฎุชุจุงุฑ:

```python
# 1. ุดุฑุงุก
POST /api/invoices
{
    "invoice_type": "ุดุฑุงุก",
    "karat_lines": [{
        "karat": 21,
        "weight_grams": 100,
        "manufacturing_wage_cash": 500
    }]
}

# โ ุงููุชูุฌุฉ ุงููุชููุนุฉ:
# - ุญุณุงุจ 1310 (ูุฎุฒูู ุฐูุจ 21): +45,367 ุฑูุงู
# - ุญุณุงุจ 1340 (ูุฎุฒูู ูุตูุนูุฉ): +500 ุฑูุงู

# 2. ุจูุน
POST /api/invoices
{
    "invoice_type": "ุจูุน",
    "karat_lines": [{
        "karat": 21,
        "weight_grams": 10,
        "manufacturing_wage_cash": 50
    }]
}

# โ ุงููุชูุฌุฉ ุงููุชููุนุฉ:
# - ุญุณุงุจ 1340: -50 ุฑูุงู (ุงุณุชููุงู)
# - ุญุณุงุจ 50 (ุชูููุฉ ุงููุจูุนุงุช): +50 ุฑูุงู
```

---

## ๐ ุงูุถูุงูุงุช ุงููุญุงุณุจูุฉ

### 1. ุงูุชูุงุฒู ุงูุฏุงุฆู
```python
verify_dual_balance(journal_entry.id)
```

### 2. ููุน ุงูุณุงูุจ
- ูุง ูููู ุจูุน ูุตูุนูุฉ ุฃูุซุฑ ูู ุงูุฑุตูุฏ ุงููุชุงุญ
- ุณูููุชุฌ ุฎุทุฃ ูู ุญุงู ุนุฏู ุงูุชูุงุฒู

### 3. ุงูุณุนุฑ ุงููุจุงุดุฑ
- ุงุณุชุฎุฏุงู `price_per_gram_main_karat` ุฏุงุฆูุงู
- ุนุฏู ุงุณุชุฎุฏุงู ุณุนุฑ ุงูุฃููุตุฉ ุฃู 24 ุนูุงุฑ

---

## ๐ ุงููุฑุงุฌุน ุงููููุฉ

### ุงููููุงุช ุงููุนุฏููุฉ:
1. `backend/routes.py` (ุฎุทูุท 1730-1760ุ 2683-2730ุ 3395-3415)
2. `backend/models.py` (ุฅุถุงูุฉ ุงูุญุณุงุจ 1340)

### ุงูุฏูุงู ุงููุณุชุฎุฏูุฉ:
- `get_account_id_by_number('1340')`
- `create_dual_journal_entry()`
- `get_current_gold_price()['price_per_gram_main_karat']`

---

## ๐ ุงููุจุงุฏุฆ ุงููุญุงุณุจูุฉ

### 1. ูุจุฏุฃ ุงูููุงุจูุฉ (Matching Principle)
```
ุชูุทุงุจู ุงููุตูุนูุฉ (ุชูููุฉ) ูุน ุงูุฅูุฑุงุฏ ูู ููุณ ุงููุชุฑุฉ
```

### 2. ูุจุฏุฃ ุงูุชูููุฉ ุงูุชุงุฑูุฎูุฉ
```
ุงููุตูุนูุฉ ุชูุณุฌู ุจุงูุชูููุฉ ุงููุนููุฉ ุนูุฏ ุงูุดุฑุงุก
```

### 3. ูุจุฏุฃ ุงูุซุจุงุช
```
ุงุณุชุฎุฏุงู ููุณ ุงูุทุฑููุฉ ูู ูู ุงูููุงุชูุฑ
```

---

## โจ ุงูุฎูุงุตุฉ

### ูุง ุชู ุฅูุฌุงุฒู:
โ ุญุณุงุจ 1340 ุฌุฏูุฏ ููููุนูู  
โ ูุตู ุงููุตูุนูุฉ ูู ุงูุดุฑุงุก  
โ ุงุณุชููุงู ุงููุตูุนูุฉ ูู ุงูุจูุน  
โ ุชุญููู ูุฒูู ุตุญูุญ  
โ ุชูุงุฒู ูุญุงุณุจู ุฏุงุฆู  

### ุงููุชูุฌุฉ ุงูููุงุฆูุฉ:
```
ูุธุงู ูุญุงุณุจู ูุชูุงูู ูุชุชุจุน ุฃุฌูุฑ ุงููุตูุนูุฉ
ุจุฏูุฉ ูุดูุงููุฉ ูุงููุฉ
```

---

**ุชุงุฑูุฎ ุงูุชูููุฐ:** 15 ุฏูุณูุจุฑ 2025  
**ุงูุญุงูุฉ:** โ ููููุฐ ูููุฎุชุจุฑ  
**ุงููุทููุฑ:** GitHub Copilot
