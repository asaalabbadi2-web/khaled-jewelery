# ๐ก๏ธ ุญูุงูุฉ ุญุฐู ุทุฑู ุงูุฏูุน ุงููุณุชุฎุฏูุฉ

## ุงููุดููุฉ
ุนูุฏ ูุญุงููุฉ ุญุฐู ุทุฑููุฉ ุฏูุน ูุณุชุฎุฏูุฉ ูู ููุงุชูุฑ ุณุงุจูุฉุ ูุญุฏุซ ุฎุทุฃ.

## ุงูุญู ุงููุทุจู โ

### 1. **ุญูุงูุฉ ุนูู ูุณุชูู Backend** 
ุงูููุฏ ูู `backend/routes.py` (ุงูุณุทุฑ 4542):
- ูุชุญูู ูู ุนุฏุฏ ุงูููุงุชูุฑ ุงููุฑุชุจุทุฉ ุจุทุฑููุฉ ุงูุฏูุน
- ุฅุฐุง ูุงูุช ูุณุชุฎุฏูุฉ โ ูุฑูุถ ุงูุญุฐู ููุนุทู ุฑุณุงูุฉ ูุงุถุญุฉ
- ุงูุฑุณุงูุฉ ุชุชุถูู:
  - ุนุฏุฏ ุงูููุงุชูุฑ ุงููุฑุชุจุทุฉ
  - ุงุณู ุทุฑููุฉ ุงูุฏูุน
  - ูุตูุญุฉ: ุงุณุชุฎุฏู ุงูุชุนุทูู ุจุฏูุงู ูู ุงูุญุฐู

```python
invoices_count = InvoicePayment.query.filter_by(payment_method_id=id).count()
if invoices_count > 0:
    return jsonify({
        'error': f'ูุง ูููู ุญุฐู ูุณููุฉ ุงูุฏูุน "{method.name}" ูุฃููุง ูุณุชุฎุฏูุฉ ูู {invoices_count} ูุงุชูุฑุฉ.\n\n๐ก ูุตูุญุฉ: ููููู ุชุนุทูู ุทุฑููุฉ ุงูุฏูุน ุจุฏูุงู ูู ุญุฐููุง ููุญูุงุธ ุนูู ุณูุงูุฉ ุงูุจูุงูุงุช ุงููุญุงุณุจูุฉ.',
        'invoices_count': invoices_count,
        'method_name': method.name,
        'can_disable': True
    }), 400
```

### 2. **ุชุญุณูู ุฑุณุงุฆู ุงูุฎุทุฃ ูู Frontend**
ุงูููุฏ ูู `frontend/lib/screens/settings_screen_enhanced.dart`:

#### ุฃ) ูุงูุฐุฉ ุชุฃููุฏ ุงูุญุฐู (ุงูุณุทุฑ ~1263)
ุชุนุฑุถ ุชุญุฐูุฑ ูุณุจู:
```
ููุงุญุธุฉ ูููุฉ:
โข ูุง ูููู ุญุฐู ุทุฑููุฉ ุฏูุน ูุณุชุฎุฏูุฉ ูู ููุงุชูุฑ
โข ููููู ุชุนุทูู ุทุฑููุฉ ุงูุฏูุน ุจุฏูุงู ูู ุญุฐููุง
```

#### ุจ) ุฑุณุงูุฉ ุงูุฎุทุฃ ุงููุญุณููุฉ (ุงูุณุทุฑ ~1326)
ุนูุฏ ูุดู ุงูุญุฐู:
- ุชุญูู ุฑุณุงูุฉ ุงูุฎุทุฃ ุชููุงุฆูุงู
- ุชุนุฑุถ ุฑุณุงูุฉ ูุงุถุญุฉ ุจุงูุนุฑุจู
- ุชูุชุฑุญ ุงูุจุฏูู: "ุจุฏูุงู ูู ุงูุญุฐูุ ููููู ุชุนุทูู ุทุฑููุฉ ุงูุฏูุน"
- ููู ุชุญุฐูุฑ (ุฃุตูุฑ) ุจุฏูุงู ูู ุฎุทุฃ (ุฃุญูุฑ)
- ูุฏุฉ ุนุฑุถ ุฃุทูู (6 ุซูุงู)

## ุงูุจุฏูู ุงูููุตู ุจู ๐ก

**ุจุฏูุงู ูู ุงูุญุฐู โ ุงุณุชุฎุฏู ุงูุชุนุทูู:**

1. ุงุถุบุท ุนูู ุฒุฑ **ุงูุชูุนูู/ุงูุชุนุทูู** (ุงูุฒุฑ ุงูุฃุฎุถุฑ/ุงูุฑูุงุฏู)
2. ุทุฑููุฉ ุงูุฏูุน ุณุชุตุจุญ **ูุนุทูุฉ** (ุบูุฑ ุธุงูุฑุฉ ูู ุงูููุงุชูุฑ ุงูุฌุฏูุฏุฉ)
3. ุงูุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ ุชุจูู **ุณูููุฉ** โ
4. ููููู **ุฅุนุงุฏุฉ ุชูุนูููุง** ูุงุญูุงู ุฅุฐุง ุงุญุชุฌุช

## ุงูููุงุฆุฏ ๐ฏ

1. **ุญูุงูุฉ ุงูุจูุงูุงุช ุงููุญุงุณุจูุฉ**: ูุง ุชููุฏ ุงูููุงุชูุฑ ุงููุฏููุฉ ูุนูููุงุช ุงูุฏูุน
2. **ุณูุงูุฉ ุงูุชูุงุฑูุฑ**: ุงูุชูุงุฑูุฑ ุงููุงููุฉ ุงูุชุงุฑูุฎูุฉ ุชุจูู ุตุญูุญุฉ
3. **ูุฑููุฉ**: ูููู ุฅุนุงุฏุฉ ุชูุนูู ุทุฑููุฉ ุงูุฏูุน ูู ุฃู ููุช
4. **ูุถูุญ**: ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ ููููุฏุฉ

## ุงุฎุชุจุงุฑ ุงูููุฒุฉ ๐งช

### ุงุฎุชุจุงุฑ 1: ุญุฐู ุทุฑููุฉ ุฏูุน ุบูุฑ ูุณุชุฎุฏูุฉ โ
```bash
# ุทุฑููุฉ ุฏูุน ุฌุฏูุฏุฉ ูู ุชุณุชุฎุฏู ูู ููุงุชูุฑ
curl -X DELETE http://localhost:8001/api/payment-methods/999
# ุงููุชูุฌุฉ: {"message": "ุชู ุงูุญุฐู ุจูุฌุงุญ"}
```

### ุงุฎุชุจุงุฑ 2: ุญุฐู ุทุฑููุฉ ุฏูุน ูุณุชุฎุฏูุฉ โ
```bash
# ุทุฑููุฉ ุฏูุน ูุณุชุฎุฏูุฉ ูู ููุงุชูุฑ (ูุซูุงู ID=6)
curl -X DELETE http://localhost:8001/api/payment-methods/6
# ุงููุชูุฌุฉ: 
{
  "error": "ูุง ูููู ุญุฐู ูุณููุฉ ุงูุฏูุน \"ููุฏู\" ูุฃููุง ูุณุชุฎุฏูุฉ ูู 1 ูุงุชูุฑุฉ.\n\n๐ก ูุตูุญุฉ: ููููู ุชุนุทูู ุทุฑููุฉ ุงูุฏูุน ุจุฏูุงู ูู ุญุฐููุง ููุญูุงุธ ุนูู ุณูุงูุฉ ุงูุจูุงูุงุช ุงููุญุงุณุจูุฉ.",
  "invoices_count": 1,
  "method_name": "ููุฏู",
  "can_disable": true
}
```

## ุงููููุงุช ุงููุนุฏูุฉ ๐

1. **Backend**:
   - `backend/routes.py` (ุงูุณุทุฑ 4542-4565)

2. **Frontend**:
   - `frontend/lib/screens/settings_screen_enhanced.dart` (ุงูุณุทุฑ 1248-1380)

## ููุงุญุธุงุช ุฅุถุงููุฉ ๐

- **ุงูุญุฐู ูุชุงุญ ููุท** ูุทุฑู ุงูุฏูุน ุงูุฌุฏูุฏุฉ ุงูุชู ูู ุชุณุชุฎุฏู ุฃุจุฏุงู
- **ุงูุชุนุทูู ูุชุงุญ ุฏุงุฆูุงู** ูุฃู ุทุฑููุฉ ุฏูุน (ูุณุชุฎุฏูุฉ ุฃู ุบูุฑ ูุณุชุฎุฏูุฉ)
- **ุฑุณุงุฆู ุงูุฎุทุฃ ุจุงูุนุฑุจู** ููุงุถุญุฉ ูููุณุชุฎุฏู ุงูููุงุฆู
- **ุญูุงูุฉ ุนูู ูุณุชูู ูุงุนุฏุฉ ุงูุจูุงูุงุช** (Foreign Key Constraint)

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ**: 16 ุฃูุชูุจุฑ 2025  
**ุงูุญุงูุฉ**: โ ูุทุจู ููุนูู
