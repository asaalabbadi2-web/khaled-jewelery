# ุฏููู ุงุณุชุฎุฏุงู ูุธุงู ุงูุณูู ุงูุชูุตูููุฉ

## ๐ฏ ุงููุฏู
ุชุชุจุน ุฏููู ูุณูู ูู ููุธู ุนูู ุญุฏุฉ ุจุงุณุชุฎุฏุงู ุญุณุงุจุงุช ุชูุตูููุฉ ูููุตูุฉ.

---

## ๐ ุงูุฅุนุฏุงุฏ ุงูุฃููู

### 1. ุฅูุดุงุก ุงูุญุณุงุจุงุช ุงูุชุฌููุนูุฉ

```bash
cd backend
source venv/bin/activate
python seed_employee_accounts.py --create
```

โ **ุงููุชูุฌุฉ:** ุณูุชู ุฅูุดุงุก ุงูุญุณุงุจ ุงูุชุฌููุนู `1400 - ุณูู ููุธููู`

---

## ๐ผ ุงูุณููุงุฑูููุงุช ุงูุนูููุฉ

### ุงูุณููุงุฑูู 1: ุตุฑู ุณููุฉ ูููุธู ุฌุฏูุฏ

#### ุงูุฎุทูุฉ 1: ูู Flutter (add_voucher_screen)

1. ุงูุชุญ ุดุงุดุฉ **ุณูุฏ ุตุฑู**
2. ุงุฎุชุฑ ูุงูุจ **"ุณููุฉ ููุธู"** ูู ุงููุณุงุนุฏ ุงูุณุฑูุน
3. ุณูุชู ููุก ุงูุจูุงูุงุช ุชููุงุฆูุงู:
   - ููุน ุงูุทุฑู: ุขุฎุฑ
   - ุงูุจูุงู: ุตุฑู ุณููุฉ ูููุธู
   - ููุน ุงููุจูุบ: ููุฏ

#### ุงูุฎุทูุฉ 2: ุงุฎุชูุงุฑ ุงูุญุณุงุจ

**ุทุฑููุชุงู:**

**ุฃ) ุงุณุชุฎุฏุงู ุงูุญุณุงุจ ุงูุชุฌููุนู (ููุณูู ุงูุจุณูุทุฉ):**
```
ุงูุญุณุงุจ: 1400 - ุณูู ููุธููู
ุงููุจูุบ: 2000 ุฑูุงู
ุงูุจูุงู: ุณููุฉ ููููุธู ุฃุญูุฏ ูุญูุฏ - EMP-2025-0001
```

**ุจ) ุงุณุชุฎุฏุงู ุญุณุงุจ ุงูุณููุฉ ุงูุชูุตููู (ูููุตู ุจู):**
```
ุงูุญุณุงุจ: 140000 - ุณููุฉ ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ
ุงููุจูุบ: 2000 ุฑูุงู
ุงูุจูุงู: ุตุฑู ุณููุฉ
```

#### ุงูุฎุทูุฉ 3: ุฅูุดุงุก ุญุณุงุจ ุงูุณููุฉ (ุฅุฐุง ูู ููู ููุฌูุฏุงู)

**ุนุจุฑ API:**
```bash
curl -X POST http://localhost:8001/api/employees/1/advance-account \
  -H "Content-Type: application/json" \
  -d '{"created_by": "admin"}'
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "account_id": 145,
  "account_number": "140000",
  "account_name": "ุณููุฉ ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ",
  "employee_id": 1
}
```

#### ุงูุฎุทูุฉ 4: ุญูุธ ุงูุณูุฏ

**ุงูููุฏ ุงููููุดุฃ:**
```
ูู ุญ/ 140000 - ุณููุฉ ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ    2000 ุฑูุงู   (ูุฏูู)
     ุฅูู ุญ/ 1000 - ุงูุฎุฒููุฉ ุงูููุฏูุฉ       2000 ุฑูุงู   (ุฏุงุฆู)
```

---

### ุงูุณููุงุฑูู 2: ุงุณุชุฑุฏุงุฏ ุงูุณููุฉ ููุฏุงู

#### ุงูุทุฑููุฉ 1: ุณูุฏ ูุจุถ ูุจุงุดุฑ

1. ุงูุชุญ ุดุงุดุฉ **ุณูุฏ ูุจุถ**
2. ุงุฎุชุฑ ูุงูุจ **"ุงุณุชุฑุฏุงุฏ ุณููุฉ"** ูู ุงููุณุงุนุฏ ุงูุณุฑูุน
3. ุงุฎุชุฑ ุงูุญุณุงุจ: `140000 - ุณููุฉ ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ`
4. ุงููุจูุบ: `2000 ุฑูุงู`
5. ุงุญูุธ ุงูุณูุฏ

**ุงูููุฏ:**
```
ูู ุญ/ 1000 - ุงูุฎุฒููุฉ ุงูููุฏูุฉ            2000 ุฑูุงู   (ูุฏูู)
     ุฅูู ุญ/ 140000 - ุณููุฉ ุฃุญูุฏ           2000 ุฑูุงู   (ุฏุงุฆู)
```

---

### ุงูุณููุงุฑูู 3: ุฎุตู ุงูุณููุฉ ูู ุงูุฑุงุชุจ

#### ุงูุทุฑููุฉ: ููุฏ ููููุฉ ูุฏูู

```
ูู ุญ/ 130000 - ุญ/ ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ       2000 ุฑูุงู   (ูุฏูู)
     ุฅูู ุญ/ 140000 - ุณููุฉ ุฃุญูุฏ           2000 ุฑูุงู   (ุฏุงุฆู)

ุงูุจูุงู: ุฎุตู ุณููุฉ ูู ุฑุงุชุจ ููููุจุฑ 2025
```

**ุงููุชูุฌุฉ:**
- ููู ุฑุตูุฏ ุณููุฉ ุงูููุธู (ูุตุจุญ ุตูุฑ ุฅุฐุง ูุงูุช ุงูุณููุฉ 2000)
- ูุฒูุฏ ุงููุณุชุญู ููููุธู ูู ุญุณุงุจู ุงูุดุฎุตู ุจููุฏุงุฑ ุงูุณููุฉ ุงููุฎุตููุฉ

---

### ุงูุณููุงุฑูู 4: ุณููุฉ ุฅุถุงููุฉ ูููุณ ุงูููุธู

#### ุฅุฐุง ูุงู ูุฏูู ุณููุฉ ุณุงุจูุฉ:

**ุงูุฎูุงุฑ 1: ุงูุณุฏุงุฏ ุฃููุงู**
- ุงุณุชุฑุฏ ุงูุณููุฉ ุงูุณุงุจูุฉ ูุงููุฉ
- ุซู ุงุตุฑู ุงูุณููุฉ ุงูุฌุฏูุฏุฉ

**ุงูุฎูุงุฑ 2: ุงูุฏูุฌ**
- ุงุตุฑู ุงูุณููุฉ ุงูุฌุฏูุฏุฉ ูู ููุณ ุงูุญุณุงุจ (140000)
- ุงูุฑุตูุฏ ุณูุชุฑุงูู (2000 + 1500 = 3500)

**ุงูููุฏ:**
```
ูู ุญ/ 140000 - ุณููุฉ ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ    1500 ุฑูุงู   (ูุฏูู)
     ุฅูู ุญ/ 1000 - ุงูุฎุฒููุฉ ุงูููุฏูุฉ       1500 ุฑูุงู   (ุฏุงุฆู)
```

**ุงูุฑุตูุฏ ุงูุฌุฏูุฏ:** `3500 ุฑูุงู` (2000 ุงููุฏููุฉ + 1500 ุงูุฌุฏูุฏุฉ)

---

## ๐ ุงูุชูุงุฑูุฑ

### 1. ุฑุตูุฏ ุณููุฉ ููุธู ูุญุฏุฏ

**ุนุจุฑ API:**
```bash
curl http://localhost:8001/api/employees/1/advance-account
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "account_id": 145,
  "account_number": "140000",
  "account_name": "ุณููุฉ ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ",
  "balance": 2000.00,
  "has_account": true
}
```

### 2. ููุฎุต ุฌููุน ุงูุณูู ุงููุณุชุญูุฉ

**ุนุจุฑ API:**
```bash
curl http://localhost:8001/api/advances/summary
```

**ุงูุงุณุชุฌุงุจุฉ:**
```json
{
  "advances": [
    {
      "advance_account_number": "140000",
      "advance_account_name": "ุณููุฉ ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ",
      "balance": 2000.00,
      "employee_code": "EMP-2025-0001",
      "employee_account": "130000"
    },
    {
      "advance_account_number": "140001",
      "advance_account_name": "ุณููุฉ ูุงุทูุฉ ุนูู ุญุณู",
      "balance": 1500.00,
      "employee_code": "EMP-2025-0002",
      "employee_account": "130001"
    }
  ],
  "total_outstanding": 3500.00,
  "count": 2
}
```

### 3. ุชูุฑูุฑ ุญุฑูุฉ ุงูุณูู (ุนุจุฑ ุงูุฃุณุชุงุฐ ุงูุนุงู)

ูู ุดุงุดุฉ **ุงูุฃุณุชุงุฐ ุงูุนุงู** (`general_ledger_screen_v2`):
- ุงุฎุชุฑ ุงูุญุณุงุจ: `140000 - ุณููุฉ ุฃุญูุฏ ูุญูุฏ ุงูุณุนูุฏ`
- ุญุฏุฏ ุงููุชุฑุฉ
- ุณูุธูุฑ ูู:
  - ุฌููุน ุงูุณูู ุงููุตุฑููุฉ (ูุฏูู)
  - ุฌููุน ุงูุงุณุชุฑุฏุงุฏุงุช (ุฏุงุฆู)
  - ุงูุฑุตูุฏ ุงูุญุงูู

---

## ๐ ุงูุงุณุชุนูุงูุงุช ุงููุจุงุดุฑุฉ

### ุงูุจุญุซ ุนู ุญุณุงุจุงุช ุงูุณูู

```sql
-- ุฌููุน ุญุณุงุจุงุช ุงูุณูู ุงููุดุทุฉ
SELECT * FROM account 
WHERE account_number LIKE '1400%' 
  AND is_active = true
ORDER BY account_number;

-- ุญุณุงุจุงุช ุงูุณูู ุงูุชู ููุง ุฑุตูุฏ
SELECT 
  a.account_number,
  a.name,
  SUM(COALESCE(jel.debit_cash, 0)) - SUM(COALESCE(jel.credit_cash, 0)) AS balance
FROM account a
LEFT JOIN journal_entry_line jel ON jel.account_id = a.id
WHERE a.account_number LIKE '1400%'
GROUP BY a.id, a.account_number, a.name
HAVING balance > 0.01
ORDER BY balance DESC;
```

---

## โ๏ธ ุงูุฅุนุฏุงุฏุงุช ุงููููุตู ุจูุง

### 1. ุณูุงุณุฉ ุงูุณูู

```
ุงูุญุฏ ุงูุฃูุตู ููุณููุฉ: ุฑุงุชุจ ุดูุฑ ูุงุญุฏ
ูุฏุฉ ุงูุงุณุชุฑุฏุงุฏ: 3 ุฃุดูุฑ ูุญุฏ ุฃูุตู
ุงูุฎุตู ุงูุดูุฑู: 33% ูู ุงูุฑุงุชุจ
ุนุฏุฏ ุงูุณูู ุงููุชุฒุงููุฉ: ุณููุฉ ูุงุญุฏุฉ ููุท
```

### 2. ูุญุต ุฏูุฑู

```bash
# ูู ุดูุฑุ ุงุญุตู ุนูู ููุฎุต ุงูุณูู
curl http://localhost:8001/api/advances/summary | python3 -m json.tool
```

---

## ๐ ุฃูุซูุฉ ูุชูุฏูุฉ

### ูุซุงู 1: ุณููุฉ ุจุงูุชูุณูุท

**ุตุฑู ุงูุณููุฉ:**
```
2025-11-01: ูู ุญ/ 140000 - ุณููุฉ ุฃุญูุฏ    3000 ุฑูุงู
                 ุฅูู ุญ/ 1000 - ุงูุฎุฒููุฉ   3000 ุฑูุงู
```

**ุงูุฎุตู ุงูุดูุฑู (1000 ุฑูุงู ร 3 ุฃุดูุฑ):**
```
2025-11-30: ูู ุญ/ 130000 - ุญ/ ุฃุญูุฏ       1000 ุฑูุงู
                 ุฅูู ุญ/ 140000 - ุณููุฉ     1000 ุฑูุงู
ุงูุจูุงู: ุงููุณุท 1/3 ูู ุณููุฉ 3000 ุฑูุงู

2025-12-31: ูู ุญ/ 130000 - ุญ/ ุฃุญูุฏ       1000 ุฑูุงู
                 ุฅูู ุญ/ 140000 - ุณููุฉ     1000 ุฑูุงู
ุงูุจูุงู: ุงููุณุท 2/3

2026-01-31: ูู ุญ/ 130000 - ุญ/ ุฃุญูุฏ       1000 ุฑูุงู
                 ุฅูู ุญ/ 140000 - ุณููุฉ     1000 ุฑูุงู
ุงูุจูุงู: ุงููุณุท 3/3 (ููุงุฆู)
```

### ูุซุงู 2: ุณููุฉ ุทุงุฑุฆุฉ

```
ุงูุจูุงู: ุณููุฉ ุทุงุฑุฆุฉ ูุธุฑู ุนุงุฆูู
ุงูุดุฑุท: ุงุณุชุฑุฏุงุฏ ุฎูุงู ุดูุฑูู
ุงูููุฏ:
  ูู ุญ/ 140000 - ุณููุฉ ุฃุญูุฏ              5000 ุฑูุงู
       ุฅูู ุญ/ 1000 - ุงูุฎุฒููุฉ            5000 ุฑูุงู

ุงูููุงุญุธุงุช: ุทุงุฑุฆุฉ - ุชูุณุชุฑุฏ ุนูู ุฏูุนุชูู (2500 ร 2)
```

---

## โ ูุงุฆูุฉ ุงูุชุญูู ูุจู ุตุฑู ุงูุณููุฉ

- [ ] ุงูููุธู ูุดุท ููู ุญุณุงุจ ุดุฎุตู (130xxx)
- [ ] ูุง ุชูุฌุฏ ุณููุฉ ุณุงุจูุฉ ุบูุฑ ููุณุฏุฏุฉ (ุฃู ุณูุงุณุฉ ุชุณูุญ ุจุงูุชุฑุงูู)
- [ ] ุงููุจูุบ ุถูู ุงูุญุฏ ุงููุณููุญ (ูุซูุงู: ุฑุงุชุจ ุดูุฑ)
- [ ] ุชู ุฅูุดุงุก ุญุณุงุจ ุงูุณููุฉ (140xxx) ุฃู ุณูููุดุฃ ุชููุงุฆูุงู
- [ ] ุงุชูุงู ูุงุถุญ ุนูู ุทุฑููุฉ ุงูุงุณุชุฑุฏุงุฏ (ููุฏ/ุฎุตู ูู ุฑุงุชุจ)
- [ ] ุชูุซูู ุงูุณููุฉ ูู ููุงุญุธุงุช ุงูุณูุฏ

---

## ๐ ุงููุดุงูู ุงูุดุงุฆุนุฉ ูุงูุญููู

| ุงููุดููุฉ | ุงูุณุจุจ | ุงูุญู |
|---------|-------|------|
| ูุง ูุธูุฑ ุญุณุงุจ ุงูุณููุฉ | ูู ูููุดุฃ ุจุนุฏ | `POST /api/employees/{id}/advance-account` |
| ุงูุฑุตูุฏ ุฎุงุทุฆ | ูููุฏ ูุชุถุงุฑุจุฉ | ุฑุงุฌุน ุชูุฑูุฑ ุงูุฃุณุชุงุฐ ุงูุนุงู ููุญุณุงุจ |
| ุชุฌุงูุฒ ุงูุณุนุฉ (10,000) | ุญุณุงุจุงุช ูุฏููุฉ ุบูุฑ ูุญุฐููุฉ | ุงุญุฐู ุญุณุงุจุงุช ุงูุณูู ุงูููุณุฏุฏุฉ ุงููุฏููุฉ |
| ุงูุญุณุงุจ ุงูุชุฌููุนู ูุธูุฑ ูู ุงูุณูุฏุงุช | ุฎุทุฃ ุงุฎุชูุงุฑ | ุงุณุชุฎุฏู ุงูุญุณุงุจ ุงูุชูุตููู (140000) |

---

## ๐ ุงูุฏุนู

ูููุฒูุฏ ูู ุงููุนูููุงุชุ ุฑุงุฌุน:
- `backend/ADVANCE_ACCOUNTS_SYSTEM.md` - ุงูุฏููู ุงูููู ุงููุงูู
- `backend/advance_account_helpers.py` - ุงูุฏูุงู ุงููุณุงุนุฏุฉ
- `backend/test_advance_accounts.py` - ุณูุฑูุจุช ุงูุงุฎุชุจุงุฑ
